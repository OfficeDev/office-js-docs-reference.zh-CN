### YamlMime:UniversalReference
ms.openlocfilehash: 97296dade336e69a6c57c7d6b4b950ff96f17304
ms.sourcegitcommit: b0b614f5315ab2e5c1e0ea51c687498f87684a07
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/15/2019
ms.locfileid: "30055078"
items:
- uid: Outlook_1_7.Office.Body
  summary: >-
    <span data-ttu-id="a479d-p101">body 对象提供为邮件或约会添加和更新内容的方法。它在所选项的 body 属性中返回。</span><span class="sxs-lookup"><span data-stu-id="a479d-p101">The body object provides methods for adding and updating the content of the message or appointment. It is returned in the body property of the selected item.</span></span>


    <span data-ttu-id="a479d-103">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-103">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-104">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-104">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-105">ReadItem</span><span class="sxs-lookup"><span data-stu-id="a479d-105">ReadItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-106">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-106">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-107">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="a479d-107">Compose or read</span></span></td></tr></table>
  name: Office.Body
  fullName: Office.Body
  langs:
  - typeScript
  type: interface
  package: Outlook_1_7
  children:
  - Outlook_1_7.Office.Body.getAsync
  - Outlook_1_7.Office.Body.getAsync_1
  - Outlook_1_7.Office.Body.getTypeAsync
  - Outlook_1_7.Office.Body.prependAsync
  - Outlook_1_7.Office.Body.prependAsync_1
  - Outlook_1_7.Office.Body.prependAsync_2
  - Outlook_1_7.Office.Body.prependAsync_3
  - Outlook_1_7.Office.Body.setAsync
  - Outlook_1_7.Office.Body.setAsync_1
  - Outlook_1_7.Office.Body.setAsync_2
  - Outlook_1_7.Office.Body.setAsync_3
  - Outlook_1_7.Office.Body.setSelectedDataAsync
  - Outlook_1_7.Office.Body.setSelectedDataAsync_1
  - Outlook_1_7.Office.Body.setSelectedDataAsync_2
  - Outlook_1_7.Office.Body.setSelectedDataAsync_3
- uid: Outlook_1_7.Office.Body.getAsync
  summary: >-
    <span data-ttu-id="a479d-108">使用指定的格式返回当前正文。</span><span class="sxs-lookup"><span data-stu-id="a479d-108">Returns the current body in a specified format.</span></span>


    <span data-ttu-id="a479d-109">此方法以 coercionType 指定的格式返回整个当前正文。</span><span class="sxs-lookup"><span data-stu-id="a479d-109">This method returns the entire current body in the format specified by coercionType.</span></span>


    <span data-ttu-id="a479d-110">使用 HTML 格式的正文时, 请务必注意 getAsync 和 setAsync 方法不是幂等。</span><span class="sxs-lookup"><span data-stu-id="a479d-110">When working with HTML-formatted bodies, it is important to note that the Body.getAsync and Body.setAsync methods are not idempotent.</span></span> <span data-ttu-id="a479d-111">从 getAsync 方法返回的值并不一定与之前在 setAsync 方法中传递的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="a479d-111">The value returned from the getAsync method will not necessarily be exactly the same as the value that was passed in the setAsync method previously.</span></span> <span data-ttu-id="a479d-112">客户端可以修改传递给 setAsync 的值, 以使其能够通过其呈现引擎高效呈现。</span><span class="sxs-lookup"><span data-stu-id="a479d-112">The client may modify the value passed to setAsync in order to make it render efficiently with its rendering engine.</span></span>


    <span data-ttu-id="a479d-113">\[[API 集: 邮箱 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-113">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-114">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-114">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-115">ReadItem</span><span class="sxs-lookup"><span data-stu-id="a479d-115">ReadItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-116">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-116">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-117">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="a479d-117">Compose or read</span></span></td></tr></table>


    <span data-ttu-id="a479d-118">除了此签名之外, 此方法还具有以下签名:</span><span class="sxs-lookup"><span data-stu-id="a479d-118">In addition to this signature, this method also has the following signature:</span></span>


    `getAsync(coercionType: Office.CoercionType, callback: (result: Office.AsyncResult<string>) => void): void;`

    #### <a name="examples"></a><span data-ttu-id="a479d-119">示例</span><span class="sxs-lookup"><span data-stu-id="a479d-119">Examples</span></span>


    ```javascript

    // This example gets the body of the message in plain text.

    Office.context.mailbox.item.body.getAsync(
        "text",
        { asyncContext: "This is passed to the callback" },
        function callback(result) {
            // Do something with the result.
        });

    // The following is an example of the result parameter passed to the callback function.

    {
        "value": "TEXT of whole body (including threads below)",
        "status": "succeeded",
        "asyncContext": "This is passed to the callback"
    }

    ```
  name: getAsync(coercionType, options, callback)
  fullName: getAsync(coercionType, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getAsync(coercionType: Office.CoercionType, options?: Office.AsyncContextOptions, callback?: (result: Office.AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: coercionType
      description: <span data-ttu-id="a479d-120">用于返回的正文的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-120">The format for the returned body.</span></span>
      type:
      - Office.CoercionType
    - id: options
      description: '<span data-ttu-id="a479d-121">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-121">Optional.</span></span> <span data-ttu-id="a479d-122">包含一个或多个以下属性的对象文本: asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-122">An object literal that contains one or more of the following properties: asyncContext: Developers can provide any object they wish to access in the callback method.</span></span>'
      type:
      - Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="a479d-123">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-123">Optional.</span></span> <span data-ttu-id="a479d-124">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-124">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-125">正文以 asyncResult.value 属性中请求的格式提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-125">The body is provided in the requested format in the asyncResult.value property.</span></span>
      type:
      - '(result: Office.AsyncResult<string>) => void'
- uid: Outlook_1_7.Office.Body.getAsync_1
  summary: >-
    <span data-ttu-id="a479d-126">使用指定的格式返回当前正文。</span><span class="sxs-lookup"><span data-stu-id="a479d-126">Returns the current body in a specified format.</span></span>


    <span data-ttu-id="a479d-127">此方法以 coercionType 指定的格式返回整个当前正文。</span><span class="sxs-lookup"><span data-stu-id="a479d-127">This method returns the entire current body in the format specified by coercionType.</span></span>


    <span data-ttu-id="a479d-128">使用 HTML 格式的正文时, 请务必注意 getAsync 和 setAsync 方法不是幂等。</span><span class="sxs-lookup"><span data-stu-id="a479d-128">When working with HTML-formatted bodies, it is important to note that the Body.getAsync and Body.setAsync methods are not idempotent.</span></span> <span data-ttu-id="a479d-129">从 getAsync 方法返回的值并不一定与之前在 setAsync 方法中传递的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="a479d-129">The value returned from the getAsync method will not necessarily be exactly the same as the value that was passed in the setAsync method previously.</span></span> <span data-ttu-id="a479d-130">客户端可以修改传递给 setAsync 的值, 以使其能够通过其呈现引擎高效呈现。</span><span class="sxs-lookup"><span data-stu-id="a479d-130">The client may modify the value passed to setAsync in order to make it render efficiently with its rendering engine.</span></span>


    <span data-ttu-id="a479d-131">\[[API 集: 邮箱 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-131">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-132">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-132">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-133">ReadItem</span><span class="sxs-lookup"><span data-stu-id="a479d-133">ReadItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-134">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-134">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-135">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="a479d-135">Compose or read</span></span></td></tr></table>
  name: getAsync(coercionType, callback)
  fullName: getAsync(coercionType, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getAsync(coercionType: Office.CoercionType, callback: (result: Office.AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: coercionType
      description: <span data-ttu-id="a479d-136">用于返回的正文的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-136">The format for the returned body.</span></span>
      type:
      - Office.CoercionType
    - id: callback
      description: <span data-ttu-id="a479d-137">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-137">Optional.</span></span> <span data-ttu-id="a479d-138">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-138">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-139">正文以 asyncResult.value 属性中请求的格式提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-139">The body is provided in the requested format in the asyncResult.value property.</span></span>
      type:
      - '(result: Office.AsyncResult<string>) => void'
- uid: Outlook_1_7.Office.Body.getTypeAsync
  summary: >-
    <span data-ttu-id="a479d-140">获取一个值，该值指示内容采用 HTML 格式还是文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-140">Gets a value that indicates whether the content is in HTML or text format.</span></span>


    <span data-ttu-id="a479d-141">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-141">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-142">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-142">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-143">ReadItem</span><span class="sxs-lookup"><span data-stu-id="a479d-143">ReadItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-144">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-144">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-145">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-145">Compose</span></span></td></tr></table><span data-ttu-id="a479d-146">

    ####说明</span><span class="sxs-lookup"><span data-stu-id="a479d-146">

    #### Examples</span></span>


    ```javascript

    Office.context.mailbox.item.body.getTypeAsync(function (asyncResult) {
        if (asyncResult.status === "failed") {
            console.log("Action failed with error: " + asyncResult.error.message);
        } else {
            console.log("Body type: " + asyncResult.value);
        }
    });

    ```
  name: getTypeAsync(options, callback)
  fullName: getTypeAsync(options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getTypeAsync(options?: Office.AsyncContextOptions, callback?: (result: Office.AsyncResult<Office.CoercionType>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: '<span data-ttu-id="a479d-147">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-147">Optional.</span></span> <span data-ttu-id="a479d-148">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-148">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-149">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-149">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span>'
      type:
      - Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="a479d-150">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-150">Optional.</span></span> <span data-ttu-id="a479d-151">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-151">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-152">内容类型作为 asyncResult.value 属性中的一个 CoercionType 值返回。</span><span class="sxs-lookup"><span data-stu-id="a479d-152">The content type is returned as one of the CoercionType values in the asyncResult.value property.</span></span>
      type:
      - '(result: Office.AsyncResult<Office.CoercionType>) => void'
- uid: Outlook_1_7.Office.Body.prependAsync
  summary: >-
    <span data-ttu-id="a479d-153">将指定内容添加到项目正文开头。</span><span class="sxs-lookup"><span data-stu-id="a479d-153">Adds the specified content to the beginning of the item body.</span></span>


    <span data-ttu-id="a479d-154">prependAsync 方法在项正文的开头插入指定的字符串。</span><span class="sxs-lookup"><span data-stu-id="a479d-154">The prependAsync method inserts the specified string at the beginning of the item body.</span></span> <span data-ttu-id="a479d-155">插入后, 光标将返回相对于插入内容的原始位置。</span><span class="sxs-lookup"><span data-stu-id="a479d-155">After insertion, the cursor is returned to its original place, relative to the inserted content.</span></span>


    <span data-ttu-id="a479d-156">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-156">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-157">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-157">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-158">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-158">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-159">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-159">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-160">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-160">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-161">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-161">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-162">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-162">Errors</span></span></td><td><span data-ttu-id="a479d-163">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-163">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr></table>


    <span data-ttu-id="a479d-164">除了此签名之外, 此方法还具有以下签名:</span><span class="sxs-lookup"><span data-stu-id="a479d-164">In addition to this signature, this method also has the following signatures:</span></span>


    `prependAsync(data: string, options: Office.AsyncContextOptions & CoercionTypeOptions): void;`


    `prependAsync(data: string, callback: (result: Office.AsyncResult<void>) => void): void;`


    `prependAsync(data: string): void;`

    #### <a name="examples"></a><span data-ttu-id="a479d-165">示例</span><span class="sxs-lookup"><span data-stu-id="a479d-165">Examples</span></span>


    ```javascript

    // When including links in HTML markup, you can disable online link preview

    // by setting the id attribute on the anchor (<a>) to "LPNoLP".

    Office.context.mailbox.item.body.prependAsync(
        '<a id="LPNoLP" href="http://www.contoso.com">Click here!</a>',
        {coercionType: Office.CoercionType.Html},
        callback);
    ```
  name: prependAsync(data, options, callback)
  fullName: prependAsync(data, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'prependAsync(data: string, options?: Office.AsyncContextOptions & CoercionTypeOptions, callback?: (result: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p110">将插入到正文开头的字符串。字符串大小限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p110">The string to be inserted at the beginning of the body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: options
      description: '<span data-ttu-id="a479d-168">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-168">Optional.</span></span> <span data-ttu-id="a479d-169">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-169">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-170">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-170">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span> <span data-ttu-id="a479d-171">coercionType: 正文所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-171">coercionType: The desired format for the body.</span></span> <span data-ttu-id="a479d-172">data 参数中的字符串将转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-172">The string in the data parameter will be converted to this format.</span></span>'
      type:
      - Office.AsyncContextOptions & CoercionTypeOptions
    - id: callback
      description: <span data-ttu-id="a479d-173">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-173">Optional.</span></span> <span data-ttu-id="a479d-174">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-174">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-175">遇到的任何错误都将在 asyncResult 属性中提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-175">Any errors encountered will be provided in the asyncResult.error property.</span></span>
      type:
      - '(result: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Body.prependAsync_1
  summary: >-
    <span data-ttu-id="a479d-176">将指定内容添加到项目正文开头。</span><span class="sxs-lookup"><span data-stu-id="a479d-176">Adds the specified content to the beginning of the item body.</span></span>


    <span data-ttu-id="a479d-177">prependAsync 方法在项正文的开头插入指定的字符串。</span><span class="sxs-lookup"><span data-stu-id="a479d-177">The prependAsync method inserts the specified string at the beginning of the item body.</span></span> <span data-ttu-id="a479d-178">插入后, 光标将返回相对于插入内容的原始位置。</span><span class="sxs-lookup"><span data-stu-id="a479d-178">After insertion, the cursor is returned to its original place, relative to the inserted content.</span></span>


    <span data-ttu-id="a479d-179">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-179">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-180">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-180">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-181">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-181">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-182">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-182">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-183">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-183">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-184">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-184">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-185">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-185">Errors</span></span></td><td><span data-ttu-id="a479d-186">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-186">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr></table>
  name: prependAsync(data, options)
  fullName: prependAsync(data, options)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'prependAsync(data: string, options: Office.AsyncContextOptions & CoercionTypeOptions): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p114">将插入到正文开头的字符串。字符串大小限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p114">The string to be inserted at the beginning of the body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: options
      description: '<span data-ttu-id="a479d-189">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-189">Optional.</span></span> <span data-ttu-id="a479d-190">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-190">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-191">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-191">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span> <span data-ttu-id="a479d-192">coercionType: 正文所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-192">coercionType: The desired format for the body.</span></span> <span data-ttu-id="a479d-193">data 参数中的字符串将转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-193">The string in the data parameter will be converted to this format.</span></span>'
      type:
      - Office.AsyncContextOptions & CoercionTypeOptions
- uid: Outlook_1_7.Office.Body.prependAsync_2
  summary: >-
    <span data-ttu-id="a479d-194">将指定内容添加到项目正文开头。</span><span class="sxs-lookup"><span data-stu-id="a479d-194">Adds the specified content to the beginning of the item body.</span></span>


    <span data-ttu-id="a479d-195">prependAsync 方法在项正文的开头插入指定的字符串。</span><span class="sxs-lookup"><span data-stu-id="a479d-195">The prependAsync method inserts the specified string at the beginning of the item body.</span></span> <span data-ttu-id="a479d-196">插入后, 光标将返回相对于插入内容的原始位置。</span><span class="sxs-lookup"><span data-stu-id="a479d-196">After insertion, the cursor is returned to its original place, relative to the inserted content.</span></span>


    <span data-ttu-id="a479d-197">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-197">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-198">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-198">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table><tr><td>[<span data-ttu-id="a479d-199">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-199">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-200">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-200">ReadWriteItem</span></span></td></tr> <tr><td>[<span data-ttu-id="a479d-201">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-201">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-202">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-202">Compose</span></span></td></tr> <tr><td><span data-ttu-id="a479d-203">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-203">Errors</span></span></td><td><span data-ttu-id="a479d-204">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-204">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr></table>
  name: prependAsync(data, callback)
  fullName: prependAsync(data, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'prependAsync(data: string, callback: (result: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p117">将插入到正文开头的字符串。字符串大小限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p117">The string to be inserted at the beginning of the body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: callback
      description: <span data-ttu-id="a479d-207">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-207">Optional.</span></span> <span data-ttu-id="a479d-208">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-208">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-209">遇到的任何错误都将在 asyncResult 属性中提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-209">Any errors encountered will be provided in the asyncResult.error property.</span></span>
      type:
      - '(result: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Body.prependAsync_3
  summary: >-
    <span data-ttu-id="a479d-210">将指定内容添加到项目正文开头。</span><span class="sxs-lookup"><span data-stu-id="a479d-210">Adds the specified content to the beginning of the item body.</span></span>


    <span data-ttu-id="a479d-211">prependAsync 方法在项正文的开头插入指定的字符串。</span><span class="sxs-lookup"><span data-stu-id="a479d-211">The prependAsync method inserts the specified string at the beginning of the item body.</span></span> <span data-ttu-id="a479d-212">插入后, 光标将返回相对于插入内容的原始位置。</span><span class="sxs-lookup"><span data-stu-id="a479d-212">After insertion, the cursor is returned to its original place, relative to the inserted content.</span></span>


    <span data-ttu-id="a479d-213">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-213">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-214">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-214">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table><tr><td>[<span data-ttu-id="a479d-215">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-215">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-216">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-216">ReadWriteItem</span></span></td></tr> <tr><td>[<span data-ttu-id="a479d-217">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-217">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-218">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-218">Compose</span></span></td></tr> <tr><td><span data-ttu-id="a479d-219">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-219">Errors</span></span></td><td><span data-ttu-id="a479d-220">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-220">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr></table>
  name: prependAsync(data)
  fullName: prependAsync(data)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'prependAsync(data: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p120">将插入到正文开头的字符串。字符串大小限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p120">The string to be inserted at the beginning of the body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
- uid: Outlook_1_7.Office.Body.setAsync
  summary: >-
    <span data-ttu-id="a479d-223">将整个正文替换为指定的文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-223">Replaces the entire body with the specified text.</span></span>


    <span data-ttu-id="a479d-224">使用 HTML 格式的正文时, 请务必注意 getAsync 和 setAsync 方法不是幂等。</span><span class="sxs-lookup"><span data-stu-id="a479d-224">When working with HTML-formatted bodies, it is important to note that the Body.getAsync and Body.setAsync methods are not idempotent.</span></span> <span data-ttu-id="a479d-225">从 getAsync 方法返回的值并不一定与之前在 setAsync 方法中传递的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="a479d-225">The value returned from the getAsync method will not necessarily be exactly the same as the value that was passed in the setAsync method previously.</span></span> <span data-ttu-id="a479d-226">客户端可以修改传递给 setAsync 的值, 以使其能够通过其呈现引擎高效呈现。</span><span class="sxs-lookup"><span data-stu-id="a479d-226">The client may modify the value passed to setAsync in order to make it render efficiently with its rendering engine.</span></span>


    <span data-ttu-id="a479d-227">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-227">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-228">\[[API 集: 邮箱 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-228">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-229">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-229">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-230">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-230">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-231">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-231">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-232">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-232">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-233">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-233">Errors</span></span></td><td><span data-ttu-id="a479d-234">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-234">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-235">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-235">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>


    <span data-ttu-id="a479d-236">除了此签名之外, 此方法还具有以下签名:</span><span class="sxs-lookup"><span data-stu-id="a479d-236">In addition to this signature, this method also has the following signatures:</span></span>


    `setAsync(data: string, options: Office.AsyncContextOptions & CoercionTypeOptions): void;`


    `setAsync(data: string, callback: (result: Office.AsyncResult<void>) => void): void;`


    `setAsync(data: string): void;`

    #### <a name="examples"></a><span data-ttu-id="a479d-237">示例</span><span class="sxs-lookup"><span data-stu-id="a479d-237">Examples</span></span>


    ```javascript

    // When including links in HTML markup, you can disable online link preview

    // by setting the id attribute on the anchor (<a>) to "LPNoLP".

    Office.context.mailbox.item.body.setAsync(
        '<a id="LPNoLP" href="http://www.contoso.com">Click here!</a>',
        {coercionType: Office.CoercionType.Html},
        callback);
    Office.context.mailbox.item.body.setAsync(
        "<b>(replaces all body, including threads you are replying to that may be on the bottom)</b>",
        { coercionType: "html", asyncContext: "This is passed to the callback" },
        function callback(result) {
            // Process the result.
    });


    // The following is an example of the result parameter passed to the callback function.

    {
        "value":null,
        "status": "succeeded",
        "asyncContext": "This is passed to the callback"
    }

    ```
  name: setAsync(data, options, callback)
  fullName: setAsync(data, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setAsync(data: string, options?: Office.AsyncContextOptions & CoercionTypeOptions, callback?: (result: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p122">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p122">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: options
      description: '<span data-ttu-id="a479d-240">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-240">Optional.</span></span> <span data-ttu-id="a479d-241">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-241">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-242">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-242">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span> <span data-ttu-id="a479d-243">coercionType: 正文所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-243">coercionType: The desired format for the body.</span></span> <span data-ttu-id="a479d-244">data 参数中的字符串将转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-244">The string in the data parameter will be converted to this format.</span></span>'
      type:
      - Office.AsyncContextOptions & CoercionTypeOptions
    - id: callback
      description: <span data-ttu-id="a479d-245">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-245">Optional.</span></span> <span data-ttu-id="a479d-246">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-246">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-247">遇到的任何错误都将在 asyncResult 属性中提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-247">Any errors encountered will be provided in the asyncResult.error property.</span></span>
      type:
      - '(result: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Body.setAsync_1
  summary: >-
    <span data-ttu-id="a479d-248">将整个正文替换为指定的文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-248">Replaces the entire body with the specified text.</span></span>


    <span data-ttu-id="a479d-249">使用 HTML 格式的正文时, 请务必注意 getAsync 和 setAsync 方法不是幂等。</span><span class="sxs-lookup"><span data-stu-id="a479d-249">When working with HTML-formatted bodies, it is important to note that the Body.getAsync and Body.setAsync methods are not idempotent.</span></span> <span data-ttu-id="a479d-250">从 getAsync 方法返回的值并不一定与之前在 setAsync 方法中传递的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="a479d-250">The value returned from the getAsync method will not necessarily be exactly the same as the value that was passed in the setAsync method previously.</span></span> <span data-ttu-id="a479d-251">客户端可以修改传递给 setAsync 的值, 以使其能够通过其呈现引擎高效呈现。</span><span class="sxs-lookup"><span data-stu-id="a479d-251">The client may modify the value passed to setAsync in order to make it render efficiently with its rendering engine.</span></span>


    <span data-ttu-id="a479d-252">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-252">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-253">\[[API 集: 邮箱 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-253">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-254">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-254">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-255">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-255">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-256">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-256">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-257">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-257">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-258">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-258">Errors</span></span></td><td><span data-ttu-id="a479d-259">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-259">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-260">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-260">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>
  name: setAsync(data, options)
  fullName: setAsync(data, options)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setAsync(data: string, options: Office.AsyncContextOptions & CoercionTypeOptions): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p126">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p126">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: options
      description: '<span data-ttu-id="a479d-263">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-263">Optional.</span></span> <span data-ttu-id="a479d-264">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-264">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-265">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-265">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span> <span data-ttu-id="a479d-266">coercionType: 正文所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-266">coercionType: The desired format for the body.</span></span> <span data-ttu-id="a479d-267">data 参数中的字符串将转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-267">The string in the data parameter will be converted to this format.</span></span>'
      type:
      - Office.AsyncContextOptions & CoercionTypeOptions
- uid: Outlook_1_7.Office.Body.setAsync_2
  summary: >-
    <span data-ttu-id="a479d-268">将整个正文替换为指定的文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-268">Replaces the entire body with the specified text.</span></span>


    <span data-ttu-id="a479d-269">使用 HTML 格式的正文时, 请务必注意 getAsync 和 setAsync 方法不是幂等。</span><span class="sxs-lookup"><span data-stu-id="a479d-269">When working with HTML-formatted bodies, it is important to note that the Body.getAsync and Body.setAsync methods are not idempotent.</span></span> <span data-ttu-id="a479d-270">从 getAsync 方法返回的值并不一定与之前在 setAsync 方法中传递的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="a479d-270">The value returned from the getAsync method will not necessarily be exactly the same as the value that was passed in the setAsync method previously.</span></span> <span data-ttu-id="a479d-271">客户端可以修改传递给 setAsync 的值, 以使其能够通过其呈现引擎高效呈现。</span><span class="sxs-lookup"><span data-stu-id="a479d-271">The client may modify the value passed to setAsync in order to make it render efficiently with its rendering engine.</span></span>


    <span data-ttu-id="a479d-272">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-272">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-273">\[[API 集: 邮箱 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-273">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-274">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-274">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-275">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-275">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-276">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-276">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-277">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-277">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-278">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-278">Errors</span></span></td><td><span data-ttu-id="a479d-279">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-279">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-280">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-280">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>
  name: setAsync(data, callback)
  fullName: setAsync(data, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setAsync(data: string, callback: (result: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p129">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p129">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: callback
      description: <span data-ttu-id="a479d-283">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-283">Optional.</span></span> <span data-ttu-id="a479d-284">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-284">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-285">遇到的任何错误都将在 asyncResult 属性中提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-285">Any errors encountered will be provided in the asyncResult.error property.</span></span>
      type:
      - '(result: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Body.setAsync_3
  summary: >-
    <span data-ttu-id="a479d-286">将整个正文替换为指定的文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-286">Replaces the entire body with the specified text.</span></span>


    <span data-ttu-id="a479d-287">使用 HTML 格式的正文时, 请务必注意 getAsync 和 setAsync 方法不是幂等。</span><span class="sxs-lookup"><span data-stu-id="a479d-287">When working with HTML-formatted bodies, it is important to note that the Body.getAsync and Body.setAsync methods are not idempotent.</span></span> <span data-ttu-id="a479d-288">从 getAsync 方法返回的值并不一定与之前在 setAsync 方法中传递的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="a479d-288">The value returned from the getAsync method will not necessarily be exactly the same as the value that was passed in the setAsync method previously.</span></span> <span data-ttu-id="a479d-289">客户端可以修改传递给 setAsync 的值, 以使其能够通过其呈现引擎高效呈现。</span><span class="sxs-lookup"><span data-stu-id="a479d-289">The client may modify the value passed to setAsync in order to make it render efficiently with its rendering engine.</span></span>


    <span data-ttu-id="a479d-290">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-290">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-291">\[[API 集: 邮箱 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-291">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-292">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-292">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-293">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-293">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-294">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-294">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-295">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-295">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-296">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-296">Errors</span></span></td><td><span data-ttu-id="a479d-297">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-297">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-298">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-298">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>
  name: setAsync(data)
  fullName: setAsync(data)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setAsync(data: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p132">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p132">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
- uid: Outlook_1_7.Office.Body.setSelectedDataAsync
  summary: >-
    <span data-ttu-id="a479d-301">将正文中的所选内容更换为指定文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-301">Replaces the selection in the body with the specified text.</span></span>


    <span data-ttu-id="a479d-302">document.setselecteddataasync 方法将指定的字符串插入到项目正文中的光标位置, 或者, 如果在编辑器中选择了文本, 则会将所选的文本替换为文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-302">The setSelectedDataAsync method inserts the specified string at the cursor location in the body of the item, or, if text is selected in the editor, it replaces the selected text.</span></span> <span data-ttu-id="a479d-303">如果光标从不在项的正文中, 或者如果项的正文在 UI 中失去焦点, 该字符串将插入到正文内容的顶部。</span><span class="sxs-lookup"><span data-stu-id="a479d-303">If the cursor was never in the body of the item, or if the body of the item lost focus in the UI, the string will be inserted at the top of the body content.</span></span> <span data-ttu-id="a479d-304">插入后, 光标放置在插入内容的末尾。</span><span class="sxs-lookup"><span data-stu-id="a479d-304">After insertion, the cursor is placed at the end of the inserted content.</span></span>


    <span data-ttu-id="a479d-305">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-305">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-306">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-306">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-307">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-307">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-308">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-308">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-309">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-309">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-310">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-310">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-311">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-311">Errors</span></span></td><td><span data-ttu-id="a479d-312">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-312">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-313">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-313">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>


    <span data-ttu-id="a479d-314">除了此签名之外, 此方法还具有以下签名:</span><span class="sxs-lookup"><span data-stu-id="a479d-314">In addition to this signature, this method also has the following signatures:</span></span>


    `setSelectedDataAsync(data: string, options: Office.AsyncContextOptions & CoercionTypeOptions): void;`


    `setSelectedDataAsync(data: string, callback: (result: Office.AsyncResult<void>) => void): void;`


    `setSelectedDataAsync(data: string): void;`

    #### <a name="examples"></a><span data-ttu-id="a479d-315">示例</span><span class="sxs-lookup"><span data-stu-id="a479d-315">Examples</span></span>


    ```javascript

    // When including links in HTML markup, you can disable online link preview

    // by setting the id attribute on the anchor (<a>) to "LPNoLP".

    Office.context.mailbox.item.body.setSelectedDataAsync(
        '<a id="LPNoLP" href="http://www.contoso.com">Click here!</a>',
        {coercionType: Office.CoercionType.Html},
        callback);
    ```
  name: setSelectedDataAsync(data, options, callback)
  fullName: setSelectedDataAsync(data, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setSelectedDataAsync(data: string, options?: Office.AsyncContextOptions & CoercionTypeOptions, callback?: (result: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p134">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p134">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: options
      description: '<span data-ttu-id="a479d-318">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-318">Optional.</span></span> <span data-ttu-id="a479d-319">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-319">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-320">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-320">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span> <span data-ttu-id="a479d-321">coercionType: 正文所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-321">coercionType: The desired format for the body.</span></span> <span data-ttu-id="a479d-322">data 参数中的字符串将转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-322">The string in the data parameter will be converted to this format.</span></span>'
      type:
      - Office.AsyncContextOptions & CoercionTypeOptions
    - id: callback
      description: <span data-ttu-id="a479d-323">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-323">Optional.</span></span> <span data-ttu-id="a479d-324">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-324">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-325">遇到的任何错误都将在 asyncResult 属性中提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-325">Any errors encountered will be provided in the asyncResult.error property.</span></span>
      type:
      - '(result: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Body.setSelectedDataAsync_1
  summary: >-
    <span data-ttu-id="a479d-326">将正文中的所选内容更换为指定文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-326">Replaces the selection in the body with the specified text.</span></span>


    <span data-ttu-id="a479d-327">document.setselecteddataasync 方法将指定的字符串插入到项目正文中的光标位置, 或者, 如果在编辑器中选择了文本, 则会将所选的文本替换为文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-327">The setSelectedDataAsync method inserts the specified string at the cursor location in the body of the item, or, if text is selected in the editor, it replaces the selected text.</span></span> <span data-ttu-id="a479d-328">如果光标从不在项的正文中, 或者如果项的正文在 UI 中失去焦点, 该字符串将插入到正文内容的顶部。</span><span class="sxs-lookup"><span data-stu-id="a479d-328">If the cursor was never in the body of the item, or if the body of the item lost focus in the UI, the string will be inserted at the top of the body content.</span></span> <span data-ttu-id="a479d-329">插入后, 光标放置在插入内容的末尾。</span><span class="sxs-lookup"><span data-stu-id="a479d-329">After insertion, the cursor is placed at the end of the inserted content.</span></span>


    <span data-ttu-id="a479d-330">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-330">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-331">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-331">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-332">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-332">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-333">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-333">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-334">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-334">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-335">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-335">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-336">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-336">Errors</span></span></td><td><span data-ttu-id="a479d-337">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-337">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-338">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-338">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>
  name: setSelectedDataAsync(data, options)
  fullName: setSelectedDataAsync(data, options)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setSelectedDataAsync(data: string, options: Office.AsyncContextOptions & CoercionTypeOptions): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p138">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p138">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: options
      description: '<span data-ttu-id="a479d-341">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-341">Optional.</span></span> <span data-ttu-id="a479d-342">包含一个或多个以下属性的对象文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-342">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="a479d-343">asyncContext: 开发人员可以在回调方法中提供要访问的任何对象。</span><span class="sxs-lookup"><span data-stu-id="a479d-343">asyncContext: Developers can provide any object they wish to access in the callback method.</span></span> <span data-ttu-id="a479d-344">coercionType: 正文所需的格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-344">coercionType: The desired format for the body.</span></span> <span data-ttu-id="a479d-345">data 参数中的字符串将转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-345">The string in the data parameter will be converted to this format.</span></span>'
      type:
      - Office.AsyncContextOptions & CoercionTypeOptions
- uid: Outlook_1_7.Office.Body.setSelectedDataAsync_2
  summary: >-
    <span data-ttu-id="a479d-346">将正文中的所选内容更换为指定文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-346">Replaces the selection in the body with the specified text.</span></span>


    <span data-ttu-id="a479d-347">document.setselecteddataasync 方法将指定的字符串插入到项目正文中的光标位置, 或者, 如果在编辑器中选择了文本, 则会将所选的文本替换为文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-347">The setSelectedDataAsync method inserts the specified string at the cursor location in the body of the item, or, if text is selected in the editor, it replaces the selected text.</span></span> <span data-ttu-id="a479d-348">如果光标从不在项的正文中, 或者如果项的正文在 UI 中失去焦点, 该字符串将插入到正文内容的顶部。</span><span class="sxs-lookup"><span data-stu-id="a479d-348">If the cursor was never in the body of the item, or if the body of the item lost focus in the UI, the string will be inserted at the top of the body content.</span></span> <span data-ttu-id="a479d-349">插入后, 光标放置在插入内容的末尾。</span><span class="sxs-lookup"><span data-stu-id="a479d-349">After insertion, the cursor is placed at the end of the inserted content.</span></span>


    <span data-ttu-id="a479d-350">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-350">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-351">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-351">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-352">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-352">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-353">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-353">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-354">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-354">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-355">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-355">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-356">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-356">Errors</span></span></td><td><span data-ttu-id="a479d-357">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-357">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-358">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-358">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>
  name: setSelectedDataAsync(data, callback)
  fullName: setSelectedDataAsync(data, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setSelectedDataAsync(data: string, callback: (result: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p141">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p141">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
    - id: callback
      description: <span data-ttu-id="a479d-361">可选。</span><span class="sxs-lookup"><span data-stu-id="a479d-361">Optional.</span></span> <span data-ttu-id="a479d-362">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="a479d-362">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span> <span data-ttu-id="a479d-363">遇到的任何错误都将在 asyncResult 属性中提供。</span><span class="sxs-lookup"><span data-stu-id="a479d-363">Any errors encountered will be provided in the asyncResult.error property.</span></span>
      type:
      - '(result: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Body.setSelectedDataAsync_3
  summary: >-
    <span data-ttu-id="a479d-364">将正文中的所选内容更换为指定文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-364">Replaces the selection in the body with the specified text.</span></span>


    <span data-ttu-id="a479d-365">document.setselecteddataasync 方法将指定的字符串插入到项目正文中的光标位置, 或者, 如果在编辑器中选择了文本, 则会将所选的文本替换为文本。</span><span class="sxs-lookup"><span data-stu-id="a479d-365">The setSelectedDataAsync method inserts the specified string at the cursor location in the body of the item, or, if text is selected in the editor, it replaces the selected text.</span></span> <span data-ttu-id="a479d-366">如果光标从不在项的正文中, 或者如果项的正文在 UI 中失去焦点, 该字符串将插入到正文内容的顶部。</span><span class="sxs-lookup"><span data-stu-id="a479d-366">If the cursor was never in the body of the item, or if the body of the item lost focus in the UI, the string will be inserted at the top of the body content.</span></span> <span data-ttu-id="a479d-367">插入后, 光标放置在插入内容的末尾。</span><span class="sxs-lookup"><span data-stu-id="a479d-367">After insertion, the cursor is placed at the end of the inserted content.</span></span>


    <span data-ttu-id="a479d-368">在 HTML 标记中包含链接时, 可以通过将定位点<!-- -->&lt;<!-- -->(a<!-- -->&gt;<!-- -->) 上的 id 属性设置为 "LPNoLP" 来禁用联机链接预览 (请参阅示例部分)。</span><span class="sxs-lookup"><span data-stu-id="a479d-368">When including links in HTML markup, you can disable online link preview by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!-- -->&gt;<!-- -->) to "LPNoLP" (please see the Examples section for a sample).</span></span>


    <span data-ttu-id="a479d-369">\[[API 集: 邮箱 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="a479d-369">\[ [API set: Mailbox 1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="a479d-370">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="a479d-370">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="a479d-371">ReadWriteItem</span><span class="sxs-lookup"><span data-stu-id="a479d-371">ReadWriteItem</span></span></td></tr>


    <tr><td>[<span data-ttu-id="a479d-372">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="a479d-372">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="a479d-373">撰写</span><span class="sxs-lookup"><span data-stu-id="a479d-373">Compose</span></span></td></tr>


    <tr><td><span data-ttu-id="a479d-374">错误</span><span class="sxs-lookup"><span data-stu-id="a479d-374">Errors</span></span></td><td><span data-ttu-id="a479d-375">DataExceedsMaximumSize-data 参数的长度超过1000000个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-375">DataExceedsMaximumSize - The data parameter is longer than 1,000,000 characters.</span></span></td></tr><tr><td></td><td><span data-ttu-id="a479d-376">InvalidFormatError-coercionType 参数设置为 coercionType, 邮件正文为纯文本格式。</span><span class="sxs-lookup"><span data-stu-id="a479d-376">InvalidFormatError - The options.coercionType parameter is set to Office.CoercionType.Html and the message body is in plain text.</span></span></td></tr></table>
  name: setSelectedDataAsync(data)
  fullName: setSelectedDataAsync(data)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setSelectedDataAsync(data: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: <span data-ttu-id="a479d-p144">将替换现有正文的字符串。字符串限制为 1,000,000 个字符。</span><span class="sxs-lookup"><span data-stu-id="a479d-p144">The string that will replace the existing body. The string is limited to 1,000,000 characters.</span></span>
      type:
      - string
