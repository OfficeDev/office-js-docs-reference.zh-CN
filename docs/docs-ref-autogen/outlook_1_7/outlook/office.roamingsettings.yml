### YamlMime:UniversalReference
items:
  - uid: outlook.Office.RoamingSettings
    summary: |-
      <span data-ttu-id="4de50-101">使用 RoamingSettings 对象的方法创建的设置将按外接程序和每个用户进行保存。</span><span class="sxs-lookup"><span data-stu-id="4de50-101">The settings created by using the methods of the RoamingSettings object are saved per add-in and per user.</span></span> <span data-ttu-id="4de50-102">即，这些设置仅供创建它们的外接程序使用，并且仅来自保存它们的用户邮箱。</span><span class="sxs-lookup"><span data-stu-id="4de50-102">That is, they are available only to the add-in that created them, and only from the user's mail box in which they are saved.</span></span>

      <span data-ttu-id="4de50-p102">虽然 Outlook 外接程序 API 仅允许创建它们的外接程序访问这些设置，但这些设置不应被视为安全存储。可以通过 Exchange Web 服务或扩展 MAPI 访问这些设置。它们不应用于存储敏感信息，如用户凭据或安全令牌。</span><span class="sxs-lookup"><span data-stu-id="4de50-p102">While the Outlook Add-in API limits access to these settings to only the add-in that created them, these settings should not be considered secure storage. They can be accessed by Exchange Web Services or Extended MAPI. They should not be used to store sensitive information such as user credentials or security tokens.</span></span>

      <span data-ttu-id="4de50-106">设置的名称是一个字符串，而值可以是字符串、数字、布尔值、null 值、对象或数组。</span><span class="sxs-lookup"><span data-stu-id="4de50-106">The name of a setting is a String, while the value can be a String, Number, Boolean, null, Object, or Array.</span></span>

      <span data-ttu-id="4de50-107">RoamingSettings 对象可通过 roamingSettings 属性在命名空间中进行访问。</span><span class="sxs-lookup"><span data-stu-id="4de50-107">The RoamingSettings object is accessible via the roamingSettings property in the Office.context namespace.</span></span>

      <span data-ttu-id="4de50-108">**重要说明**: 只有在首次加载加载项时, 才会从持久化存储初始化 RoamingSettings 对象。</span><span class="sxs-lookup"><span data-stu-id="4de50-108">**Important**: The RoamingSettings object is initialized from the persisted storage only when the add-in is first loaded.</span></span> <span data-ttu-id="4de50-109">对于任务窗格, 这意味着仅在第一次打开任务窗格时才会对其进行初始化。</span><span class="sxs-lookup"><span data-stu-id="4de50-109">For task panes, this means that it is only initialized when the task pane first opens.</span></span> <span data-ttu-id="4de50-110">如果任务窗格导航到另一个页面或重新加载当前页面, 则内存中的对象将重置为其初始值, 即使您的外接程序具有持续的更改也是如此。</span><span class="sxs-lookup"><span data-stu-id="4de50-110">If the task pane navigates to another page or reloads the current page, the in-memory object is reset to its initial values, even if your add-in has persisted changes.</span></span> <span data-ttu-id="4de50-111">在关闭并重新打开任务窗格 (或在 UI 较少的加载项的情况下) 之前, 保留的更改将不可用。</span><span class="sxs-lookup"><span data-stu-id="4de50-111">The persisted changes will not be available until the task pane (or item in the case of UI-less add-ins) is closed and reopened.</span></span>

      <span data-ttu-id="4de50-112">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="4de50-112">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
    remarks: |-
      <span data-ttu-id="4de50-113">**[最低权限级别](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: 受限</span><span class="sxs-lookup"><span data-stu-id="4de50-113">**[Minimum permission level](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: Restricted</span></span>

      <span data-ttu-id="4de50-114">**[适用的 Outlook 模式](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: 撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="4de50-114">**[Applicable Outlook mode](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: Compose or Read</span></span>

      #### <a name="examples"></a><span data-ttu-id="4de50-115">示例</span><span class="sxs-lookup"><span data-stu-id="4de50-115">Examples</span></span>

      ```javascript
      // Get the current value of the 'myKey' setting.
      var value = Office.context.roamingSettings.get('myKey');
      // Update the value of the 'myKey' setting.
      Office.context.roamingSettings.set('myKey', 'Hello World!');
      // Persist the change.
      Office.context.roamingSettings.saveAsync();
      ```
    name: Office.RoamingSettings
    fullName: Office.RoamingSettings
    langs:
      - typeScript
    type: interface
    package: outlook
    children:
      - outlook.Office.RoamingSettings.get
      - outlook.Office.RoamingSettings.remove
      - outlook.Office.RoamingSettings.saveAsync
      - outlook.Office.RoamingSettings.set
  - uid: outlook.Office.RoamingSettings.get
    summary: |-
      <span data-ttu-id="4de50-116">检索指定设置。</span><span class="sxs-lookup"><span data-stu-id="4de50-116">Retrieves the specified setting.</span></span>

      <span data-ttu-id="4de50-117">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="4de50-117">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
    remarks: |-
      <span data-ttu-id="4de50-118">**[最低权限级别](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: 受限</span><span class="sxs-lookup"><span data-stu-id="4de50-118">**[Minimum permission level](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: Restricted</span></span>

      <span data-ttu-id="4de50-119">**[适用的 Outlook 模式](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: 撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="4de50-119">**[Applicable Outlook mode](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: Compose or Read</span></span>
    name: get(name)
    fullName: get(name)
    langs:
      - typeScript
    type: method
    syntax:
      content: 'get(name: string): any;'
      return:
        type:
          - any
        description: '<span data-ttu-id="4de50-120">类型: String \| Number \| Boolean \|对象\|数组</span><span class="sxs-lookup"><span data-stu-id="4de50-120">Type: String \| Number \| Boolean \| Object \| Array</span></span>'
      parameters:
        - id: name
          description: <span data-ttu-id="4de50-121">要检索的设置的区分大小写的名称。</span><span class="sxs-lookup"><span data-stu-id="4de50-121">The case-sensitive name of the setting to retrieve.</span></span>
          type:
            - string
  - uid: outlook.Office.RoamingSettings.remove
    summary: |-
      <span data-ttu-id="4de50-122">删除指定的设置</span><span class="sxs-lookup"><span data-stu-id="4de50-122">Removes the specified setting</span></span>

      <span data-ttu-id="4de50-123">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="4de50-123">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
    remarks: |-
      <span data-ttu-id="4de50-124">**[最低权限级别](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: 受限</span><span class="sxs-lookup"><span data-stu-id="4de50-124">**[Minimum permission level](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: Restricted</span></span>

      <span data-ttu-id="4de50-125">**[适用的 Outlook 模式](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: 撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="4de50-125">**[Applicable Outlook mode](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: Compose or Read</span></span>
    name: remove(name)
    fullName: remove(name)
    langs:
      - typeScript
    type: method
    syntax:
      content: 'remove(name: string): void;'
      return:
        type:
          - void
        description: ''
      parameters:
        - id: name
          description: <span data-ttu-id="4de50-126">要移除的设置的区分大小写的名称。</span><span class="sxs-lookup"><span data-stu-id="4de50-126">The case-sensitive name of the setting to remove.</span></span>
          type:
            - string
  - uid: outlook.Office.RoamingSettings.saveAsync
    summary: |-
      <span data-ttu-id="4de50-127">保存设置。</span><span class="sxs-lookup"><span data-stu-id="4de50-127">Saves the settings.</span></span>

      <span data-ttu-id="4de50-128">加载项以前保存的任何设置都会在初始化时加载, 因此, 在会话的生存期期间, 可以只使用 set 和 get 方法来处理设置属性包的内存副本。</span><span class="sxs-lookup"><span data-stu-id="4de50-128">Any settings previously saved by an add-in are loaded when it is initialized, so during the lifetime of the session you can just use the set and get methods to work with the in-memory copy of the settings property bag.</span></span> <span data-ttu-id="4de50-129">如果希望保留设置以便可在下次使用外接程序时使用这些设置，请使用 saveAsync 方法。</span><span class="sxs-lookup"><span data-stu-id="4de50-129">When you want to persist the settings so that they are available the next time the add-in is used, use the saveAsync method.</span></span>

      <span data-ttu-id="4de50-130">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="4de50-130">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
    remarks: |-
      <span data-ttu-id="4de50-131">**[最低权限级别](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: 受限</span><span class="sxs-lookup"><span data-stu-id="4de50-131">**[Minimum permission level](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: Restricted</span></span>

      <span data-ttu-id="4de50-132">**[适用的 Outlook 模式](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: 撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="4de50-132">**[Applicable Outlook mode](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: Compose or Read</span></span>
    name: saveAsync(callback)
    fullName: saveAsync(callback)
    langs:
      - typeScript
    type: method
    syntax:
      content: 'saveAsync(callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
      return:
        type:
          - void
        description: ''
      parameters:
        - id: callback
          description: '<span data-ttu-id="4de50-133">可选。</span><span class="sxs-lookup"><span data-stu-id="4de50-133">Optional.</span></span> <span data-ttu-id="4de50-134">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="4de50-134">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span>'
          type:
            - '(asyncResult: Office.AsyncResult<void>) => void'
  - uid: outlook.Office.RoamingSettings.set
    summary: |-
      <span data-ttu-id="4de50-135">设置或创建指定设置。</span><span class="sxs-lookup"><span data-stu-id="4de50-135">Sets or creates the specified setting.</span></span>

      <span data-ttu-id="4de50-p106">set 方法创建指定名称的新设置（如果该设置尚不存在），或者设置指定名称的现有设置。该值在文档中存储为其数据类型的序列化 JSON 表示形式。</span><span class="sxs-lookup"><span data-stu-id="4de50-p106">The set method creates a new setting of the specified name if it does not already exist, or sets an existing setting of the specified name. The value is stored in the document as the serialized JSON representation of its data type.</span></span>

      <span data-ttu-id="4de50-138">每个加载项的设置最多可使用32KB。</span><span class="sxs-lookup"><span data-stu-id="4de50-138">A maximum of 32KB is available for the settings of each add-in.</span></span>

      <span data-ttu-id="4de50-139">在调用 saveAsync 函数之前, 使用 set 函数对设置所做的任何更改都不会保存到服务器。</span><span class="sxs-lookup"><span data-stu-id="4de50-139">Any changes made to settings using the set function will not be saved to the server until the saveAsync function is called.</span></span>

      <span data-ttu-id="4de50-140">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="4de50-140">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
    remarks: |-
      <span data-ttu-id="4de50-141">**[最低权限级别](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: 受限</span><span class="sxs-lookup"><span data-stu-id="4de50-141">**[Minimum permission level](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->**: Restricted</span></span>

      <span data-ttu-id="4de50-142">**[适用的 Outlook 模式](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: 撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="4de50-142">**[Applicable Outlook mode](https://docs.microsoft.com/outlook/add-ins/#extension-points)<!-- -->**: Compose or Read</span></span>
    name: 'set(name, value)'
    fullName: 'set(name, value)'
    langs:
      - typeScript
    type: method
    syntax:
      content: 'set(name: string, value: any): void;'
      return:
        type:
          - void
        description: ''
      parameters:
        - id: name
          description: <span data-ttu-id="4de50-143">要设置或创建的设置的名称（区分大小写）。</span><span class="sxs-lookup"><span data-stu-id="4de50-143">The case-sensitive name of the setting to set or create.</span></span>
          type:
            - string
        - id: value
          description: <span data-ttu-id="4de50-144">Specifies the value to be stored.</span><span class="sxs-lookup"><span data-stu-id="4de50-144">Specifies the value to be stored.</span></span>
          type:
            - any