### YamlMime:UniversalReference
items:
  - uid: 'office!Office.UI:interface'
    summary: |-
      <span data-ttu-id="e8341-101">提供可用于在 Office 外接程序中创建和操作 UI 组件（如对话框）的对象和方法。</span><span class="sxs-lookup"><span data-stu-id="e8341-101">Provides objects and methods that you can use to create and manipulate UI components, such as dialog boxes, in your Office Add-ins.</span></span>

      <span data-ttu-id="e8341-102">访问 "[在 Office 外接程序中使用对话框 API](https://docs.microsoft.com/office/dev/add-ins/develop/dialog-api-in-office-add-ins) "</span><span class="sxs-lookup"><span data-stu-id="e8341-102">Visit "[Use the Dialog API in your Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/develop/dialog-api-in-office-add-ins)</span></span><!-- --><span data-ttu-id="e8341-103">"了解详细信息。</span><span class="sxs-lookup"><span data-stu-id="e8341-103">" for more information.</span></span>
    name: Office.UI
    fullName: Office.UI
    langs:
      - typeScript
    type: interface
    package: office!
    children:
      - 'office!Office.UI#closeContainer:member(1)'
      - 'office!Office.UI#displayDialogAsync:member(1)'
      - 'office!Office.UI#displayDialogAsync:member(2)'
      - 'office!Office.UI#messageParent:member(1)'
  - uid: 'office!Office.UI#closeContainer:member(1)'
    summary: <span data-ttu-id="e8341-104">关闭正在执行 JavaScript 的 UI 容器。</span><span class="sxs-lookup"><span data-stu-id="e8341-104">Closes the UI container where the JavaScript is executing.</span></span>
    remarks: |-
      <span data-ttu-id="e8341-105">**主机**： Excel、Word、PowerPoint、Outlook （最低要求集：邮箱1.5）</span><span class="sxs-lookup"><span data-stu-id="e8341-105">**Hosts**: Excel, Word, PowerPoint, Outlook (Minimum requirement set: Mailbox 1.5)</span></span>

      <span data-ttu-id="e8341-106">**要求集**： [DialogAPI](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/dialog-api-requirement-sets)</span><span class="sxs-lookup"><span data-stu-id="e8341-106">**Requirement set**: [DialogAPI](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/dialog-api-requirement-sets)</span></span>

      <span data-ttu-id="e8341-107">此方法的行为由以下内容指定：</span><span class="sxs-lookup"><span data-stu-id="e8341-107">The behavior of this method is specified by the following:</span></span>

      - <span data-ttu-id="e8341-108">从无 UI 的命令按钮调用：不起作用。</span><span class="sxs-lookup"><span data-stu-id="e8341-108">Called from a UI-less command button: No effect.</span></span> <span data-ttu-id="e8341-109">displayDialogAsync 打开的任何对话框将保持打开状态。</span><span class="sxs-lookup"><span data-stu-id="e8341-109">Any dialog opened by displayDialogAsync will remain open.</span></span>

      - <span data-ttu-id="e8341-110">从任务窗格调用：任务窗格将关闭。</span><span class="sxs-lookup"><span data-stu-id="e8341-110">Called from a task pane: The task pane will close.</span></span> <span data-ttu-id="e8341-111">由 displayDialogAsync 打开的任何对话框也将关闭。</span><span class="sxs-lookup"><span data-stu-id="e8341-111">Any dialog opened by displayDialogAsync will also close.</span></span> <span data-ttu-id="e8341-112">如果任务窗格支持固定且由用户固定，则它将被取消锁定。</span><span class="sxs-lookup"><span data-stu-id="e8341-112">If the task pane supports pinning and was pinned by the user, it will be un-pinned.</span></span>

      - <span data-ttu-id="e8341-113">从模块扩展中调用：不起作用。</span><span class="sxs-lookup"><span data-stu-id="e8341-113">Called from a module extension: No effect.</span></span>
    name: closeContainer()
    fullName: closeContainer()
    langs:
      - typeScript
    type: method
    syntax:
      content: 'closeContainer(): void;'
      return:
        type:
          - void
        description: ''
  - uid: 'office!Office.UI#displayDialogAsync:member(1)'
    summary: <span data-ttu-id="e8341-114">显示用于显示或收集用户信息或便于 Web 导航的对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-114">Displays a dialog to show or collect information from the user or to facilitate Web navigation.</span></span>
    remarks: |-
      <span data-ttu-id="e8341-115">**主机**： Word、Excel、Outlook、PowerPoint</span><span class="sxs-lookup"><span data-stu-id="e8341-115">**Hosts**: Word, Excel, Outlook, PowerPoint</span></span>

      <span data-ttu-id="e8341-116">**要求集**：</span><span class="sxs-lookup"><span data-stu-id="e8341-116">**Requirement sets**:</span></span>

      - [<span data-ttu-id="e8341-117">DialogAPI</span><span class="sxs-lookup"><span data-stu-id="e8341-117">DialogAPI</span></span>](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/dialog-api-requirement-sets)

      - [<span data-ttu-id="e8341-118">Mailbox 1.4</span><span class="sxs-lookup"><span data-stu-id="e8341-118">Mailbox 1.4</span></span>](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)

      <span data-ttu-id="e8341-119">此方法适用于 Word、Excel 或 PowerPoint 加载项的 DialogApi 要求集，以及邮箱要求集 1.4 for Outlook。</span><span class="sxs-lookup"><span data-stu-id="e8341-119">This method is available in the DialogApi requirement set for Word, Excel, or PowerPoint add-ins, and in the Mailbox requirement set 1.4 for Outlook.</span></span> <span data-ttu-id="e8341-120">有关如何在清单中指定要求集的详细信息，请参阅[指定 Office 主机和 API 要求](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)</span><span class="sxs-lookup"><span data-stu-id="e8341-120">For more on how to specify a requirement set in your manifest, see [Specify Office hosts and API requirements](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)</span></span><!-- --><span data-ttu-id="e8341-121">.</span><span class="sxs-lookup"><span data-stu-id="e8341-121"></span></span>

      <span data-ttu-id="e8341-122">初始页必须与父页位于同一域中（startAddress 参数）。</span><span class="sxs-lookup"><span data-stu-id="e8341-122">The initial page must be on the same domain as the parent page (the startAddress parameter).</span></span> <span data-ttu-id="e8341-123">初始网页加载后，你可以转到其他域。</span><span class="sxs-lookup"><span data-stu-id="e8341-123">After the initial page loads, you can go to other domains.</span></span>

      <span data-ttu-id="e8341-124">任何页调用`office.context.ui.messageParent`也必须与父页位于同一域中。</span><span class="sxs-lookup"><span data-stu-id="e8341-124">Any page calling `office.context.ui.messageParent` must also be on the same domain as the parent page.</span></span>

      <span data-ttu-id="e8341-125">**设计注意事项**：</span><span class="sxs-lookup"><span data-stu-id="e8341-125">**Design considerations**:</span></span>

      <span data-ttu-id="e8341-126">下列设计注意事项适用于对话框：</span><span class="sxs-lookup"><span data-stu-id="e8341-126">The following design considerations apply to dialog boxes:</span></span>

      - <span data-ttu-id="e8341-127">Office 外接程序任务窗格在任何时候都只能有一个打开的对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-127">An Office Add-in task pane can have only one dialog box open at any time.</span></span> <span data-ttu-id="e8341-128">可以从加载项命令同时打开多个对话框（自定义功能区按钮或菜单项）。</span><span class="sxs-lookup"><span data-stu-id="e8341-128">Multiple dialogs can be open at the same time from Add-in Commands (custom ribbon buttons or menu items).</span></span>

      - <span data-ttu-id="e8341-129">用户可以移动每个对话框和调整其大小。</span><span class="sxs-lookup"><span data-stu-id="e8341-129">Every dialog box can be moved and resized by the user.</span></span>

      - <span data-ttu-id="e8341-130">每个对话框在打开时都在屏幕上居中显示。</span><span class="sxs-lookup"><span data-stu-id="e8341-130">Every dialog box is centered on the screen when opened.</span></span>

      - <span data-ttu-id="e8341-131">对话框按照创建的顺序出现在主机应用程序顶部。</span><span class="sxs-lookup"><span data-stu-id="e8341-131">Dialog boxes appear on top of the host application and in the order in which they were created.</span></span>

      <span data-ttu-id="e8341-132">使用对话框可以执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="e8341-132">Use a dialog box to:</span></span>

      - <span data-ttu-id="e8341-133">显示身份验证页以收集用户凭据。</span><span class="sxs-lookup"><span data-stu-id="e8341-133">Display authentication pages to collect user credentials.</span></span>

      - <span data-ttu-id="e8341-134">显示来自 ShowTaskpane 或 ExecuteAction 命令的错误/进度/输入屏幕。</span><span class="sxs-lookup"><span data-stu-id="e8341-134">Display an error/progress/input screen from a ShowTaskpane or ExecuteAction command.</span></span>

      - <span data-ttu-id="e8341-135">临时增加用户可用于完成一项任务的表面区域。</span><span class="sxs-lookup"><span data-stu-id="e8341-135">Temporarily increase the surface area that a user has available to complete a task.</span></span>

      <span data-ttu-id="e8341-p106">不要使用对话框与文档进行交互。而是使用任务窗格。</span><span class="sxs-lookup"><span data-stu-id="e8341-p106">Do not use a dialog box to interact with a document. Use a task pane instead.</span></span>

      <span data-ttu-id="e8341-138">有关可以用于创建对话框的设计模式，请参阅 GitHub 的 Office 外接程序 UX 设计模式存储库中的 [客户端对话框](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md)。</span><span class="sxs-lookup"><span data-stu-id="e8341-138">For a design pattern that you can use to create a dialog box, see [Client Dialog](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md) in the Office Add-in UX Design Patterns repository on GitHub.</span></span>

      <span data-ttu-id="e8341-139">**DisplayDialogAsync 错误**：</span><span class="sxs-lookup"><span data-stu-id="e8341-139">**displayDialogAsync Errors**:</span></span>

      <table> <tr> <th><span data-ttu-id="e8341-140">代码编号</span><span class="sxs-lookup"><span data-stu-id="e8341-140">Code number</span></span></th> <th><span data-ttu-id="e8341-141">含义</span><span class="sxs-lookup"><span data-stu-id="e8341-141">Meaning</span></span></th> </tr> <tr> <td><span data-ttu-id="e8341-142">12004</span><span class="sxs-lookup"><span data-stu-id="e8341-142">12004</span></span></td> <td><span data-ttu-id="e8341-143">传递给 displayDialogAsync 的 URL 的域不受信任。</span><span class="sxs-lookup"><span data-stu-id="e8341-143">The domain of the URL passed to displayDialogAsync is not trusted.</span></span> <span data-ttu-id="e8341-144">该域必须与主机页（包括协议和端口号）具有同一域，或必须在外接程序清单的 <AppDomains> 部分中注册。</span><span class="sxs-lookup"><span data-stu-id="e8341-144">The domain must be either the same domain as the host page (including protocol and port number), or it must be registered in the <AppDomains> section of the add-in manifest.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-145">12005</span><span class="sxs-lookup"><span data-stu-id="e8341-145">12005</span></span></td> <td><span data-ttu-id="e8341-146">传递给 displayDialogAsync 的 URL 使用 HTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="e8341-146">The URL passed to displayDialogAsync uses the HTTP protocol.</span></span> <span data-ttu-id="e8341-147">必须使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="e8341-147">HTTPS is required.</span></span> <span data-ttu-id="e8341-148">（在 Office 的某些版本中，返回 12005 的错误消息与返回 12004 错误消息是相同的。）</span><span class="sxs-lookup"><span data-stu-id="e8341-148">(In some versions of Office, the error message returned with 12005 is the same one returned for 12004.)</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-149">12007</span><span class="sxs-lookup"><span data-stu-id="e8341-149">12007</span></span></td> <td><span data-ttu-id="e8341-p109">从任务窗格已经打开了一个对话框。任务窗格外接程序一次只能打开一个对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-p109">A dialog box is already opened from the task pane. A task pane add-in can only have one dialog box open at a time.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-152">12009</span><span class="sxs-lookup"><span data-stu-id="e8341-152">12009</span></span></td> <td><span data-ttu-id="e8341-153">用户已选择忽略对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-153">The user chose to ignore the dialog box.</span></span> <span data-ttu-id="e8341-154">联机版本的 Office 中可能会发生此错误，用户可能会选择不允许加载项显示对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-154">This error can occur in online versions of Office, where users may choose not to allow an add-in to present a dialog.</span></span></td> </tr> </table>

      <span data-ttu-id="e8341-155">在传递给 displayDialogAsync 方法的回调函数中，您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class="sxs-lookup"><span data-stu-id="e8341-155">In the callback function passed to the displayDialogAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>

      <table> <tr> <th><span data-ttu-id="e8341-156">属性</span><span class="sxs-lookup"><span data-stu-id="e8341-156">Property</span></span></th> <th><span data-ttu-id="e8341-157">用于</span><span class="sxs-lookup"><span data-stu-id="e8341-157">Use to</span></span></th> </tr> <tr> <td><span data-ttu-id="e8341-158">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="e8341-158">AsyncResult.value</span></span></td> <td><span data-ttu-id="e8341-159">访问 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="e8341-159">Access the Dialog object.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-160">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="e8341-160">AsyncResult.status</span></span></td> <td><span data-ttu-id="e8341-161">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="e8341-161">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-162">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="e8341-162">AsyncResult.error</span></span></td> <td><span data-ttu-id="e8341-163">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="e8341-163">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-164">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="e8341-164">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="e8341-165">如果您将用户定义的一个 object 或值作为 asyncContext 参数传递，则对其进行访问。</span><span class="sxs-lookup"><span data-stu-id="e8341-165">Access your user-defined object or value, if you passed one as the asyncContext parameter.</span></span></td> </tr> </table>
    name: 'displayDialogAsync(startAddress, options, callback)'
    fullName: 'displayDialogAsync(startAddress, options, callback)'
    langs:
      - typeScript
    type: method
    syntax:
      content: 'displayDialogAsync(startAddress: string, options?: DialogOptions, callback?: (result: AsyncResult<Dialog>) => void): void;'
      return:
        type:
          - void
        description: ''
      parameters:
        - id: startAddress
          description: <span data-ttu-id="e8341-166">接受在对话框中打开的初始 HTTPS URL。</span><span class="sxs-lookup"><span data-stu-id="e8341-166">Accepts the initial HTTPS URL that opens in the dialog.</span></span>
          type:
            - string
        - id: options
          description: '<span data-ttu-id="e8341-167">可选。</span><span class="sxs-lookup"><span data-stu-id="e8341-167">Optional.</span></span> <span data-ttu-id="e8341-168">接受[DialogOptions](xref:office!Office.DialogOptions:interface)对象以定义对话框显示。</span><span class="sxs-lookup"><span data-stu-id="e8341-168">Accepts an [Office.DialogOptions](xref:office!Office.DialogOptions:interface) object to define dialog display.</span></span>'
          type:
            - 'office!Office.DialogOptions:interface'
        - id: callback
          description: '<span data-ttu-id="e8341-169">可选。</span><span class="sxs-lookup"><span data-stu-id="e8341-169">Optional.</span></span> <span data-ttu-id="e8341-170">接受用于处理对话框创建尝试的 callback 方法。</span><span class="sxs-lookup"><span data-stu-id="e8341-170">Accepts a callback method to handle the dialog creation attempt.</span></span> <span data-ttu-id="e8341-171">如果成功，AsyncResult 的值是 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="e8341-171">If successful, the AsyncResult.value is a Dialog object.</span></span>'
          type:
            - 'office!Office.UI#displayDialogAsync~0:complex'
  - uid: 'office!Office.UI#displayDialogAsync:member(2)'
    summary: <span data-ttu-id="e8341-172">显示用于显示或收集用户信息或便于 Web 导航的对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-172">Displays a dialog to show or collect information from the user or to facilitate Web navigation.</span></span>
    remarks: |-
      <span data-ttu-id="e8341-173">**主机**： Excel、Outlook、PowerPoint、Word</span><span class="sxs-lookup"><span data-stu-id="e8341-173">**Hosts**: Excel, Outlook, PowerPoint, Word</span></span>

      <span data-ttu-id="e8341-174">**要求集**：</span><span class="sxs-lookup"><span data-stu-id="e8341-174">**Requirement sets**:</span></span>

      - [<span data-ttu-id="e8341-175">DialogAPI</span><span class="sxs-lookup"><span data-stu-id="e8341-175">DialogAPI</span></span>](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/dialog-api-requirement-sets)

      - [<span data-ttu-id="e8341-176">Mailbox 1.4</span><span class="sxs-lookup"><span data-stu-id="e8341-176">Mailbox 1.4</span></span>](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)

      <span data-ttu-id="e8341-177">此方法适用于 Word、Excel 或 PowerPoint 加载项的 DialogApi 要求集，以及邮箱要求集 1.4 for Outlook。</span><span class="sxs-lookup"><span data-stu-id="e8341-177">This method is available in the DialogApi requirement set for Word, Excel, or PowerPoint add-ins, and in the Mailbox requirement set 1.4 for Outlook.</span></span> <span data-ttu-id="e8341-178">有关如何在清单中指定要求集的详细信息，请参阅[指定 Office 主机和 API 要求](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)</span><span class="sxs-lookup"><span data-stu-id="e8341-178">For more on how to specify a requirement set in your manifest, see [Specify Office hosts and API requirements](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)</span></span><!-- --><span data-ttu-id="e8341-179">.</span><span class="sxs-lookup"><span data-stu-id="e8341-179"></span></span>

      <span data-ttu-id="e8341-180">初始页必须与父页位于同一域中（startAddress 参数）。</span><span class="sxs-lookup"><span data-stu-id="e8341-180">The initial page must be on the same domain as the parent page (the startAddress parameter).</span></span> <span data-ttu-id="e8341-181">初始网页加载后，你可以转到其他域。</span><span class="sxs-lookup"><span data-stu-id="e8341-181">After the initial page loads, you can go to other domains.</span></span>

      <span data-ttu-id="e8341-182">任何页调用`office.context.ui.messageParent`也必须与父页位于同一域中。</span><span class="sxs-lookup"><span data-stu-id="e8341-182">Any page calling `office.context.ui.messageParent` must also be on the same domain as the parent page.</span></span>

      <span data-ttu-id="e8341-183">**设计注意事项**：</span><span class="sxs-lookup"><span data-stu-id="e8341-183">**Design considerations**:</span></span>

      <span data-ttu-id="e8341-184">下列设计注意事项适用于对话框：</span><span class="sxs-lookup"><span data-stu-id="e8341-184">The following design considerations apply to dialog boxes:</span></span>

      - <span data-ttu-id="e8341-185">Office 外接程序任务窗格在任何时候都只能有一个打开的对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-185">An Office Add-in task pane can have only one dialog box open at any time.</span></span> <span data-ttu-id="e8341-186">可以从加载项命令同时打开多个对话框（自定义功能区按钮或菜单项）。</span><span class="sxs-lookup"><span data-stu-id="e8341-186">Multiple dialogs can be open at the same time from Add-in Commands (custom ribbon buttons or menu items).</span></span>

      - <span data-ttu-id="e8341-187">用户可以移动每个对话框和调整其大小。</span><span class="sxs-lookup"><span data-stu-id="e8341-187">Every dialog box can be moved and resized by the user.</span></span>

      - <span data-ttu-id="e8341-188">每个对话框在打开时都在屏幕上居中显示。</span><span class="sxs-lookup"><span data-stu-id="e8341-188">Every dialog box is centered on the screen when opened.</span></span>

      - <span data-ttu-id="e8341-189">对话框按照创建的顺序出现在主机应用程序顶部。</span><span class="sxs-lookup"><span data-stu-id="e8341-189">Dialog boxes appear on top of the host application and in the order in which they were created.</span></span>

      <span data-ttu-id="e8341-190">使用对话框可以执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="e8341-190">Use a dialog box to:</span></span>

      - <span data-ttu-id="e8341-191">显示身份验证页以收集用户凭据。</span><span class="sxs-lookup"><span data-stu-id="e8341-191">Display authentication pages to collect user credentials.</span></span>

      - <span data-ttu-id="e8341-192">显示来自 ShowTaskpane 或 ExecuteAction 命令的错误/进度/输入屏幕。</span><span class="sxs-lookup"><span data-stu-id="e8341-192">Display an error/progress/input screen from a ShowTaskpane or ExecuteAction command.</span></span>

      - <span data-ttu-id="e8341-193">临时增加用户可用于完成一项任务的表面区域。</span><span class="sxs-lookup"><span data-stu-id="e8341-193">Temporarily increase the surface area that a user has available to complete a task.</span></span>

      <span data-ttu-id="e8341-p116">不要使用对话框与文档进行交互。而是使用任务窗格。</span><span class="sxs-lookup"><span data-stu-id="e8341-p116">Do not use a dialog box to interact with a document. Use a task pane instead.</span></span>

      <span data-ttu-id="e8341-196">有关可以用于创建对话框的设计模式，请参阅 GitHub 的 Office 外接程序 UX 设计模式存储库中的 [客户端对话框](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md)。</span><span class="sxs-lookup"><span data-stu-id="e8341-196">For a design pattern that you can use to create a dialog box, see [Client Dialog](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md) in the Office Add-in UX Design Patterns repository on GitHub.</span></span>

      <span data-ttu-id="e8341-197">**DisplayDialogAsync 错误**：</span><span class="sxs-lookup"><span data-stu-id="e8341-197">**displayDialogAsync Errors**:</span></span>

      <table> <tr> <th><span data-ttu-id="e8341-198">代码编号</span><span class="sxs-lookup"><span data-stu-id="e8341-198">Code number</span></span></th> <th><span data-ttu-id="e8341-199">含义</span><span class="sxs-lookup"><span data-stu-id="e8341-199">Meaning</span></span></th> </tr> <tr> <td><span data-ttu-id="e8341-200">12004</span><span class="sxs-lookup"><span data-stu-id="e8341-200">12004</span></span></td> <td><span data-ttu-id="e8341-201">传递给 displayDialogAsync 的 URL 的域不受信任。</span><span class="sxs-lookup"><span data-stu-id="e8341-201">The domain of the URL passed to displayDialogAsync is not trusted.</span></span> <span data-ttu-id="e8341-202">该域必须与主机页（包括协议和端口号）具有同一域，或必须在外接程序清单的 <AppDomains> 部分中注册。</span><span class="sxs-lookup"><span data-stu-id="e8341-202">The domain must be either the same domain as the host page (including protocol and port number), or it must be registered in the <AppDomains> section of the add-in manifest.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-203">12005</span><span class="sxs-lookup"><span data-stu-id="e8341-203">12005</span></span></td> <td><span data-ttu-id="e8341-204">传递给 displayDialogAsync 的 URL 使用 HTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="e8341-204">The URL passed to displayDialogAsync uses the HTTP protocol.</span></span> <span data-ttu-id="e8341-205">必须使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="e8341-205">HTTPS is required.</span></span> <span data-ttu-id="e8341-206">（在 Office 的某些版本中，返回 12005 的错误消息与返回 12004 错误消息是相同的。）</span><span class="sxs-lookup"><span data-stu-id="e8341-206">(In some versions of Office, the error message returned with 12005 is the same one returned for 12004.)</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-207">12007</span><span class="sxs-lookup"><span data-stu-id="e8341-207">12007</span></span></td> <td><span data-ttu-id="e8341-p119">从任务窗格已经打开了一个对话框。任务窗格外接程序一次只能打开一个对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-p119">A dialog box is already opened from the task pane. A task pane add-in can only have one dialog box open at a time.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-210">12009</span><span class="sxs-lookup"><span data-stu-id="e8341-210">12009</span></span></td> <td><span data-ttu-id="e8341-211">用户已选择忽略对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-211">The user chose to ignore the dialog box.</span></span> <span data-ttu-id="e8341-212">联机版本的 Office 中可能会发生此错误，用户可能会选择不允许加载项显示对话框。</span><span class="sxs-lookup"><span data-stu-id="e8341-212">This error can occur in online versions of Office, where users may choose not to allow an add-in to present a dialog.</span></span></td> </tr> </table>

      <span data-ttu-id="e8341-213">在传递给 displayDialogAsync 方法的回调函数中，您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class="sxs-lookup"><span data-stu-id="e8341-213">In the callback function passed to the displayDialogAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>

      <table> <tr> <th><span data-ttu-id="e8341-214">属性</span><span class="sxs-lookup"><span data-stu-id="e8341-214">Property</span></span></th> <th><span data-ttu-id="e8341-215">用于</span><span class="sxs-lookup"><span data-stu-id="e8341-215">Use to</span></span></th> </tr> <tr> <td><span data-ttu-id="e8341-216">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="e8341-216">AsyncResult.value</span></span></td> <td><span data-ttu-id="e8341-217">访问 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="e8341-217">Access the Dialog object.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-218">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="e8341-218">AsyncResult.status</span></span></td> <td><span data-ttu-id="e8341-219">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="e8341-219">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-220">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="e8341-220">AsyncResult.error</span></span></td> <td><span data-ttu-id="e8341-221">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="e8341-221">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="e8341-222">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="e8341-222">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="e8341-223">如果您将用户定义的一个 object 或值作为 asyncContext 参数传递，则对其进行访问。</span><span class="sxs-lookup"><span data-stu-id="e8341-223">Access your user-defined object or value, if you passed one as the asyncContext parameter.</span></span></td> </tr> </table>
    name: 'displayDialogAsync(startAddress, callback)'
    fullName: 'displayDialogAsync(startAddress, callback)'
    langs:
      - typeScript
    type: method
    syntax:
      content: 'displayDialogAsync(startAddress: string, callback?: (result: AsyncResult<Dialog>) => void): void;'
      return:
        type:
          - void
        description: ''
      parameters:
        - id: startAddress
          description: <span data-ttu-id="e8341-224">接受在对话框中打开的初始 HTTPS URL。</span><span class="sxs-lookup"><span data-stu-id="e8341-224">Accepts the initial HTTPS URL that opens in the dialog.</span></span>
          type:
            - string
        - id: callback
          description: '<span data-ttu-id="e8341-225">可选。</span><span class="sxs-lookup"><span data-stu-id="e8341-225">Optional.</span></span> <span data-ttu-id="e8341-226">接受用于处理对话框创建尝试的 callback 方法。</span><span class="sxs-lookup"><span data-stu-id="e8341-226">Accepts a callback method to handle the dialog creation attempt.</span></span> <span data-ttu-id="e8341-227">如果成功，AsyncResult 的值是 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="e8341-227">If successful, the AsyncResult.value is a Dialog object.</span></span>'
          type:
            - 'office!Office.UI#displayDialogAsync~1:complex'
  - uid: 'office!Office.UI#messageParent:member(1)'
    summary: <span data-ttu-id="e8341-p122">将对话框中的消息传送到其父页/开始页。调用此 API 的页必须与父页位于相同的域。</span><span class="sxs-lookup"><span data-stu-id="e8341-p122">Delivers a message from the dialog box to its parent/opener page. The page calling this API must be on the same domain as the parent.</span></span>
    remarks: '<span data-ttu-id="e8341-230">**要求集**： [DialogAPI](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/dialog-api-requirement-sets)</span><span class="sxs-lookup"><span data-stu-id="e8341-230">**Requirement set**: [DialogAPI](https://docs.microsoft.com/office/dev/add-ins/reference/requirement-sets/dialog-api-requirement-sets)</span></span>'
    name: messageParent(message)
    fullName: messageParent(message)
    langs:
      - typeScript
    type: method
    syntax:
      content: 'messageParent(message: boolean | string): void;'
      return:
        type:
          - void
        description: ''
      parameters:
        - id: message
          description: '<span data-ttu-id="e8341-231">接受从对话框传送到外接程序的消息。</span><span class="sxs-lookup"><span data-stu-id="e8341-231">Accepts a message from the dialog to deliver to the add-in.</span></span> <span data-ttu-id="e8341-232">除了布尔值之外，可以将任何可序列化为字符串的任何内容（包括 JSON 和 XML）都可以发送。</span><span class="sxs-lookup"><span data-stu-id="e8341-232">In addition to a boolean, anything that can serialized to a string including JSON and XML can be sent.</span></span>'
          type:
            - boolean | string
references:
  - uid: 'office!Office.DialogOptions:interface'
    name: DialogOptions
  - uid: 'office!Office.UI#displayDialogAsync~0:complex'
    name: '(result: AsyncResult<Dialog>) => void'
    fullName: '(result: Office.AsyncResult<Office.Dialog>) => void'
    spec.typeScript:
      - name: '(result: '
        fullName: '(result: '
      - uid: 'office!Office.AsyncResult:interface'
        name: AsyncResult
        fullName: Office.AsyncResult
      - name: <
        fullName: <
      - uid: 'office!Office.Dialog:interface'
        name: Dialog
        fullName: Office.Dialog
      - name: '>) => void'
        fullName: '>) => void'
  - uid: 'office!Office.UI#displayDialogAsync~1:complex'
    name: '(result: AsyncResult<Dialog>) => void'
    fullName: '(result: Office.AsyncResult<Office.Dialog>) => void'
    spec.typeScript:
      - name: '(result: '
        fullName: '(result: '
      - uid: 'office!Office.AsyncResult:interface'
        name: AsyncResult
        fullName: Office.AsyncResult
      - name: <
        fullName: <
      - uid: 'office!Office.Dialog:interface'
        name: Dialog
        fullName: Office.Dialog
      - name: '>) => void'
        fullName: '>) => void'