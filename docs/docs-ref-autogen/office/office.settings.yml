### YamlMime:UniversalReference
ms.openlocfilehash: ba8bb19feca95da10060b7bf35ac6063913360e9
ms.sourcegitcommit: b0b614f5315ab2e5c1e0ea51c687498f87684a07
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/15/2019
ms.locfileid: "30054959"
items:
- uid: office.Office.Settings
  summary: <span data-ttu-id="7e89d-101">表示作为名称/值对存储在主机文档中的任务窗格或内容外接程序的自定义设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-101">Represents custom settings for a task pane or content add-in that are stored in the host document as name/value pairs.</span></span>
  remarks: >-
    <table> <tr><td><span data-ttu-id="7e89d-102">主机</span><span class="sxs-lookup"><span data-stu-id="7e89d-102">Hosts</span></span></td><td><span data-ttu-id="7e89d-103">Access、Excel、PowerPoint 和 Word</span><span class="sxs-lookup"><span data-stu-id="7e89d-103">Access, Excel, PowerPoint, Word</span></span></td></tr> <tr><td><span data-ttu-id="7e89d-104">要求集</span><span class="sxs-lookup"><span data-stu-id="7e89d-104">Requirement Sets</span></span></td><td><span data-ttu-id="7e89d-105">设置</span><span class="sxs-lookup"><span data-stu-id="7e89d-105">Settings</span></span></td></tr> </table>


    <span data-ttu-id="7e89d-106">使用 settings 对象的方法创建的设置将针对每个加载项和文档进行保存。</span><span class="sxs-lookup"><span data-stu-id="7e89d-106">The settings created by using the methods of the Settings object are saved per add-in and per document.</span></span> <span data-ttu-id="7e89d-107">也就是说, 它们仅可用于创建它们的外接程序, 并且只能从保存它们的文档中使用。</span><span class="sxs-lookup"><span data-stu-id="7e89d-107">That is, they are available only to the add-in that created them, and only from the document in which they are saved.</span></span>


    <span data-ttu-id="7e89d-108">设置的名称是一个字符串, 而值可以是字符串、数字、布尔值、null、对象或数组。</span><span class="sxs-lookup"><span data-stu-id="7e89d-108">The name of a setting is a string, while the value can be a string, number, boolean, null, object, or array.</span></span>


    <span data-ttu-id="7e89d-109">设置对象将作为 Document 对象的一部分自动加载, 并可通过在外接程序激活时调用该对象的 Settings 属性。</span><span class="sxs-lookup"><span data-stu-id="7e89d-109">The Settings object is automatically loaded as part of the Document object, and is available by calling the settings property of that object when the add-in is activated.</span></span>


    <span data-ttu-id="7e89d-110">开发人员负责在添加或删除设置后调用 saveAsync 方法, 以保存文档中的设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-110">The developer is responsible for calling the saveAsync method after adding or deleting settings to save the settings in the document.</span></span>
  name: Office.Settings
  fullName: Office.Settings
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.Settings.addHandlerAsync
  - office.Office.Settings.addHandlerAsync_1
  - office.Office.Settings.get
  - office.Office.Settings.refreshAsync
  - office.Office.Settings.remove
  - office.Office.Settings.removeHandlerAsync
  - office.Office.Settings.removeHandlerAsync_1
  - office.Office.Settings.saveAsync
  - office.Office.Settings.saveAsync_1
  - office.Office.Settings.set
- uid: office.Office.Settings.addHandlerAsync
  summary: >-
    <span data-ttu-id="7e89d-111">为 settingsChanged 事件添加事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="7e89d-111">Adds an event handler for the settingsChanged event.</span></span>


    <span data-ttu-id="7e89d-112">**重要说明**: 当外接程序使用任何 excel 客户端运行时, 外接程序的代码可以为 settingsChanged 事件注册处理程序, 但只有在加载加载项时, 将会触发该事件, 并在 Excel Online 中打开一个电子表格, 并且多个用户正在编辑电子表格 (共同创作)。</span><span class="sxs-lookup"><span data-stu-id="7e89d-112">**Important**: Your add-in's code can register a handler for the settingsChanged event when the add-in is running with any Excel client, but the event will fire only when the add-in is loaded with a spreadsheet that is opened in Excel Online, and more than one user is editing the spreadsheet (co-authoring).</span></span> <span data-ttu-id="7e89d-113">因此, 仅在共同创作方案的 Excel Online 中有效地支持 settingsChanged 事件。</span><span class="sxs-lookup"><span data-stu-id="7e89d-113">Therefore, effectively the settingsChanged event is supported only in Excel Online in co-authoring scenarios.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="7e89d-114">要求集</span><span class="sxs-lookup"><span data-stu-id="7e89d-114">Requirement Sets</span></span></td><td><span data-ttu-id="7e89d-115">设置</span><span class="sxs-lookup"><span data-stu-id="7e89d-115">Settings</span></span></td></tr></table>


    <span data-ttu-id="7e89d-116">只要每个事件处理程序函数的名称是唯一的, 您就可以为指定的事件类型添加多个事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="7e89d-116">You can add multiple event handlers for the specified eventType as long as the name of each event handler function is unique.</span></span>
  name: addHandlerAsync(eventType, handler, options, callback)
  fullName: addHandlerAsync(eventType, handler, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: any, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: <span data-ttu-id="7e89d-p103">指定要添加的事件的类型。必需。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p103">Specifies the type of event to add. Required.</span></span>
      type:
      - Office.EventType
    - id: handler
      description: <span data-ttu-id="7e89d-119">要添加的事件处理程序函数, 其唯一的参数的类型为[SettingsChangedEventArgs](xref:office.Office.SettingsChangedEventArgs)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="7e89d-119">The event handler function to add, whose only parameter is of type [Office.SettingsChangedEventArgs](xref:office.Office.SettingsChangedEventArgs)<!-- -->.</span></span> <span data-ttu-id="7e89d-120">必需。</span><span class="sxs-lookup"><span data-stu-id="7e89d-120">Required.</span></span>
      type:
      - any
    - id: options
      description: <span data-ttu-id="7e89d-121">提供一个选项, 用于保留任何类型的未更改的上下文数据, 以供在回调中使用。</span><span class="sxs-lookup"><span data-stu-id="7e89d-121">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: >-
        <span data-ttu-id="7e89d-122">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-122">Optional.</span></span> <span data-ttu-id="7e89d-123">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-123">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>


        <table> <tr> <th><span data-ttu-id="7e89d-124">属性</span><span class="sxs-lookup"><span data-stu-id="7e89d-124">Property</span></span></th> <th><span data-ttu-id="7e89d-125">用于...</span><span class="sxs-lookup"><span data-stu-id="7e89d-125">Use to...</span></span></th> </tr> <tr> <td><span data-ttu-id="7e89d-126">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="7e89d-126">AsyncResult.value</span></span></td> <td><span data-ttu-id="7e89d-127">始终返回 undefined, 这是因为添加事件处理程序时没有要检索的数据或对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-127">Always returns undefined because there is no data or object to retrieve when adding an event handler.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-128">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="7e89d-128">AsyncResult.status</span></span></td> <td><span data-ttu-id="7e89d-129">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="7e89d-129">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-130">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="7e89d-130">AsyncResult.error</span></span></td> <td><span data-ttu-id="7e89d-131">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-131">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-132">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="7e89d-132">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="7e89d-133">在 AsyncResult 对象中未经改动的返回的任何类型的用户定义项。</span><span class="sxs-lookup"><span data-stu-id="7e89d-133">A user-defined item of any type that is returned in the AsyncResult object without being altered.</span></span></td> </tr> </table>


        <span data-ttu-id="7e89d-134">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="7e89d-134">**Support details**</span></span>


        <span data-ttu-id="7e89d-p106">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p106">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


        <span data-ttu-id="7e89d-137">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class="sxs-lookup"><span data-stu-id="7e89d-137">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


        <span data-ttu-id="7e89d-138">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="7e89d-138">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="7e89d-139">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="7e89d-139">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="7e89d-140">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="7e89d-140">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="7e89d-141">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="7e89d-141">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="7e89d-142"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-142"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-143">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-143">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id="7e89d-144"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-144"><strong> Excel </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-145">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-145">Y</span></span> </td><td> </td></tr> </table>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.addHandlerAsync_1
  summary: >-
    <span data-ttu-id="7e89d-146">为 settingsChanged 事件添加事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="7e89d-146">Adds an event handler for the settingsChanged event.</span></span>


    <span data-ttu-id="7e89d-147">**重要说明**: 当外接程序使用任何 excel 客户端运行时, 外接程序的代码可以为 settingsChanged 事件注册处理程序, 但只有在加载加载项时, 将会触发该事件, 并在 Excel Online 中打开一个电子表格, 并且多个用户正在编辑电子表格 (共同创作)。</span><span class="sxs-lookup"><span data-stu-id="7e89d-147">**Important**: Your add-in's code can register a handler for the settingsChanged event when the add-in is running with any Excel client, but the event will fire only when the add-in is loaded with a spreadsheet that is opened in Excel Online, and more than one user is editing the spreadsheet (co-authoring).</span></span> <span data-ttu-id="7e89d-148">因此, 仅在共同创作方案的 Excel Online 中有效地支持 settingsChanged 事件。</span><span class="sxs-lookup"><span data-stu-id="7e89d-148">Therefore, effectively the settingsChanged event is supported only in Excel Online in co-authoring scenarios.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"7e89d-149\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-149\">Requirement Sets</span></span></td><td><span data-ttu-id=\"7e89d-150\">设置</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-150\">Settings</span></span></td></tr></table>\n\n<span data-ttu-id=\"7e89d-151\">只要每个事件处理程序函数的名称是唯一的, 您就可以为指定的事件类型添加多个事件处理程序。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-151\">You can add multiple event handlers for the specified eventType as long as the name of each event handler function is unique.</span></span>\n#### <a name=\"examples\"></a><span data-ttu-id=\"7e89d-152\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-152\">Examples</span></span>\n\n```javascript\nfunction addSelectionChangedEventHandler() {\n    Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged, MyHandler);\n}\n\nfunction MyHandler(eventArgs) {\n    write('Event raised: ' + eventArgs.type);\n    doSomethingWithSettings(eventArgs.settings);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: addHandlerAsync(eventType, handler, callback)
  fullName: addHandlerAsync(eventType, handler, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: any, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: <span data-ttu-id="7e89d-p108">指定要添加的事件的类型。必需。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p108">Specifies the type of event to add. Required.</span></span>
      type:
      - Office.EventType
    - id: handler
      description: <span data-ttu-id="7e89d-155">要添加的事件处理程序函数, 其唯一的参数的类型为[SettingsChangedEventArgs](xref:office.Office.SettingsChangedEventArgs)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="7e89d-155">The event handler function to add, whose only parameter is of type [Office.SettingsChangedEventArgs](xref:office.Office.SettingsChangedEventArgs)<!-- -->.</span></span> <span data-ttu-id="7e89d-156">必需。</span><span class="sxs-lookup"><span data-stu-id="7e89d-156">Required.</span></span>
      type:
      - any
    - id: callback
      description: >-
        <span data-ttu-id="7e89d-157">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-157">Optional.</span></span> <span data-ttu-id="7e89d-158">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-158">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>


        <table> <tr> <th><span data-ttu-id="7e89d-159">属性</span><span class="sxs-lookup"><span data-stu-id="7e89d-159">Property</span></span></th> <th><span data-ttu-id="7e89d-160">用于...</span><span class="sxs-lookup"><span data-stu-id="7e89d-160">Use to...</span></span></th> </tr> <tr> <td><span data-ttu-id="7e89d-161">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="7e89d-161">AsyncResult.value</span></span></td> <td><span data-ttu-id="7e89d-162">始终返回 undefined, 这是因为添加事件处理程序时没有要检索的数据或对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-162">Always returns undefined because there is no data or object to retrieve when adding an event handler.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-163">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="7e89d-163">AsyncResult.status</span></span></td> <td><span data-ttu-id="7e89d-164">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="7e89d-164">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-165">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="7e89d-165">AsyncResult.error</span></span></td> <td><span data-ttu-id="7e89d-166">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-166">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-167">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="7e89d-167">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="7e89d-168">在 AsyncResult 对象中未经改动的返回的任何类型的用户定义项。</span><span class="sxs-lookup"><span data-stu-id="7e89d-168">A user-defined item of any type that is returned in the AsyncResult object without being altered.</span></span></td> </tr> </table>


        <span data-ttu-id="7e89d-169">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="7e89d-169">**Support details**</span></span>


        <span data-ttu-id="7e89d-p111">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p111">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


        <span data-ttu-id="7e89d-172">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class="sxs-lookup"><span data-stu-id="7e89d-172">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


        <span data-ttu-id="7e89d-173">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="7e89d-173">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="7e89d-174">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="7e89d-174">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="7e89d-175">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="7e89d-175">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="7e89d-176">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="7e89d-176">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="7e89d-177"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-177"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-178">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-178">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id="7e89d-179"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-179"><strong> Excel </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-180">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-180">Y</span></span> </td><td> </td></tr> </table>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.get
  summary: <span data-ttu-id="7e89d-181">检索指定设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-181">Retrieves the specified setting.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"7e89d-182\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-182\">Requirement Sets</span></span></td><td><span data-ttu-id=\"7e89d-183\">设置</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-183\">Settings</span></span></td></tr></table>\n\n<span data-ttu-id=\"7e89d-184\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-184\">**Support details**</span></span>\n\n<span data-ttu-id=\"7e89d-p112\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-p112\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"7e89d-187\">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-187\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"7e89d-188\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-188\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"7e89d-189\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-189\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"7e89d-190\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-190\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"7e89d-191\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-191\">Office for iPad</span></span> </th><th> <span data-ttu-id=\"7e89d-192\">Office for Mac?</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-192\">Office for Mac</span></span> </th></tr> <tr><td><span data-ttu-id=\"7e89d-193\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-193\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"7e89d-194\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-194\">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id=\"7e89d-195\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-195\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"7e89d-196\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-196\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-197\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-197\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-198\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-198\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-199\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-199\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"7e89d-200\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-200\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"7e89d-201\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-201\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-202\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-202\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-203\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-203\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-204\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-204\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"7e89d-205\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-205\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"7e89d-206\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-206\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-207\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-207\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-208\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-208\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-209\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-209\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"7e89d-210\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-210\">Examples</span></span>\n\n```javascript\nfunction displayMySetting() {\n    write('Current value for mySetting: ' + Office.context.document.settings.get('mySetting'));\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: get(name)
  fullName: get(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'get(name: string): any;'
    return:
      type:
      - any
      description: <span data-ttu-id="7e89d-211">具有映射到 JSON 序列化值的属性名称的对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-211">An object that has property names mapped to JSON serialized values.</span></span>
    parameters:
    - id: name
      description: ''
      type:
      - string
- uid: office.Office.Settings.refreshAsync
  summary: <span data-ttu-id="7e89d-212">读取文档中保存的所有设置并刷新内容或任务窗格外接程序在内存中保留的这些设置的副本。</span><span class="sxs-lookup"><span data-stu-id="7e89d-212">Reads all settings persisted in the document and refreshes the content or task pane add-in's copy of those settings held in memory.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"7e89d-213\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-213\">Requirement Sets</span></span></td><td><span data-ttu-id=\"7e89d-214\">设置</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-214\">Settings</span></span></td></tr></table>\n\n<span data-ttu-id=\"7e89d-215\">当同一加载项的多个实例在同一文档中运行时, 此方法在 Excel、Word 和 PowerPoint 合著方案中非常有用。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-215\">This method is useful in Excel, Word, and PowerPoint coauthoring scenarios when multiple instances of the same add-in are working against the same document.</span></span> <span data-ttu-id=\"7e89d-216\">由于每个加载项都在用户打开文档时从该文档加载的设置的内存中副本运行, 因此每个用户使用的设置值可能会不同步。只要外接程序的实例调用 saveAsync 方法以将该用户的所有设置都保留到文档中, 就会发生这种情况。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-216\">Because each add-in is working against an in-memory copy of the settings loaded from the document at the time the user opened it, the settings values used by each user can get out of sync. This can happen whenever an instance of the add-in calls the Settings.saveAsync method to persist all of that user's settings to the document.</span></span> <span data-ttu-id=\"7e89d-217\">从外接程序的 settingsChanged 事件的事件处理程序中调用 refreshAsync 方法将会刷新所有用户的设置值。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-217\">Calling the refreshAsync method from the event handler for the settingsChanged event of the add-in will refresh the settings values for all users.</span></span>\n\n<span data-ttu-id=\"7e89d-218\">在传递给 refreshAsync 方法的回调函数中, 您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-218\">In the callback function passed to the refreshAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>\n\n<table> <tr> <th><span data-ttu-id=\"7e89d-219\">属性</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-219\">Property</span></span></th> <th><span data-ttu-id=\"7e89d-220\">用于...</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-220\">Use to...</span></span></th> </tr> <tr> <td><span data-ttu-id=\"7e89d-221\">AsyncResult.value</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-221\">AsyncResult.value</span></span></td> <td><span data-ttu-id=\"7e89d-222\">访问包含刷新后的值的 Settings 对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-222\">Access a Settings object with the refreshed values.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"7e89d-223\">AsyncResult.status</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-223\">AsyncResult.status</span></span></td> <td><span data-ttu-id=\"7e89d-224\">确定操作是成功还是失败。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-224\">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"7e89d-225\">AsyncResult.error</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-225\">AsyncResult.error</span></span></td> <td><span data-ttu-id=\"7e89d-226\">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-226\">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"7e89d-227\">AsyncResult.asyncContext</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-227\">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id=\"7e89d-228\">在 AsyncResult 对象中未经改动的返回的任何类型的用户定义项。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-228\">A user-defined item of any type that is returned in the AsyncResult object without being altered.</span></span></td> </tr> </table>\n\n<span data-ttu-id=\"7e89d-229\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-229\">**Support details**</span></span>\n\n<span data-ttu-id=\"7e89d-p114\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-p114\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"7e89d-232\">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-232\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"7e89d-233\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-233\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"7e89d-234\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-234\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"7e89d-235\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-235\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"7e89d-236\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-236\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"7e89d-237\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-237\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"7e89d-238\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-238\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"7e89d-239\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-239\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"7e89d-240\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-240\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-241\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-241\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"7e89d-242\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-242\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"7e89d-243\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-243\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-244\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-244\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"7e89d-245\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-245\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"7e89d-246\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-246\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-247\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-247\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"7e89d-248\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-248\">Examples</span></span>\n\n```javascript\nfunction refreshSettings() {\n    Office.context.document.settings.refreshAsync(function (asyncResult) {\n        write('Settings refreshed with status: ' + asyncResult.status);\n    });\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: refreshAsync(callback)
  fullName: refreshAsync(callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'refreshAsync(callback?: (result: AsyncResult<Office.Settings>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: <span data-ttu-id="7e89d-249">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-249">Optional.</span></span> <span data-ttu-id="7e89d-250">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-250">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="7e89d-251">结果`value`的属性是一个包含刷新值的[Office. Settings](xref:office.Office.Settings)对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-251">The `value` property of the result is an [Office.Settings](xref:office.Office.Settings) object with the refreshed values.</span></span>
      type:
      - '(result: AsyncResult<Office.Settings>) => void'
- uid: office.Office.Settings.remove
  summary: >-
    <span data-ttu-id="7e89d-252">移除指定设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-252">Removes the specified setting.</span></span>


    <span data-ttu-id="7e89d-253">**重要说明**: 请注意, settings 方法仅影响设置属性包的内存中副本。</span><span class="sxs-lookup"><span data-stu-id="7e89d-253">**Important**: Be aware that the Settings.remove method affects only the in-memory copy of the settings property bag.</span></span> <span data-ttu-id="7e89d-254">若要在文档中保留指定设置的删除, 请在调用 settings 方法之后的某个时间点, 然后在关闭外接加载项之前, 必须调用 saveAsync 方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-254">To persist the removal of the specified setting in the document, at some point after calling the Settings.remove method and before the add-in is closed, you must call the Settings.saveAsync method.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="7e89d-255">要求集</span><span class="sxs-lookup"><span data-stu-id="7e89d-255">Requirement Sets</span></span></td><td><span data-ttu-id="7e89d-256">设置</span><span class="sxs-lookup"><span data-stu-id="7e89d-256">Settings</span></span></td></tr></table>


    <span data-ttu-id="7e89d-p117">null 是设置的有效值。因此，将 null 分配给设置不会将它从设置属性包中删除。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p117">null is a valid value for a setting. Therefore, assigning null to the setting will not remove it from the settings property bag.</span></span>


    <span data-ttu-id="7e89d-259">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="7e89d-259">**Support details**</span></span>


    <span data-ttu-id="7e89d-p118">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p118">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="7e89d-262">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class="sxs-lookup"><span data-stu-id="7e89d-262">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="7e89d-263">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="7e89d-263">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="7e89d-264">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="7e89d-264">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="7e89d-265">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="7e89d-265">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="7e89d-266">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="7e89d-266">Office for iPad</span></span> </th><th> <span data-ttu-id="7e89d-267">Office for Mac?</span><span class="sxs-lookup"><span data-stu-id="7e89d-267">Office for Mac</span></span> </th></tr> <tr><td><span data-ttu-id="7e89d-268"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-268"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-269">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-269">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id="7e89d-270"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-270"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="7e89d-271">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-271">Y</span></span> </td><td> <span data-ttu-id="7e89d-272">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-272">Y</span></span> </td><td> <span data-ttu-id="7e89d-273">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-273">Y</span></span> </td><td> <span data-ttu-id="7e89d-274">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-274">Y</span></span> </td></tr> <tr><td><span data-ttu-id="7e89d-275"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-275"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="7e89d-276">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-276">Y</span></span> </td><td> <span data-ttu-id="7e89d-277">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-277">Y</span></span> </td><td> <span data-ttu-id="7e89d-278">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-278">Y</span></span> </td><td> <span data-ttu-id="7e89d-279">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-279">Y</span></span> </td></tr> <tr><td><span data-ttu-id="7e89d-280"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-280"><strong> Word </strong></span></span></td><td> <span data-ttu-id="7e89d-281">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-281">Y</span></span> </td><td> <span data-ttu-id="7e89d-282">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-282">Y</span></span> </td><td> <span data-ttu-id="7e89d-283">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-283">Y</span></span> </td><td> <span data-ttu-id="7e89d-284">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-284">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="7e89d-285">示例</span><span class="sxs-lookup"><span data-stu-id="7e89d-285">Examples</span></span>


    ```javascript

    function removeMySetting() {
        Office.context.document.settings.remove('mySetting');
    }

    ```
  name: remove(name)
  fullName: remove(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'remove(name: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: ''
      type:
      - string
- uid: office.Office.Settings.removeHandlerAsync
  summary: <span data-ttu-id="7e89d-286">删除 settingsChanged 事件的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="7e89d-286">Removes an event handler for the settingsChanged event.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="7e89d-287">要求集</span><span class="sxs-lookup"><span data-stu-id="7e89d-287">Requirement Sets</span></span></td><td><span data-ttu-id="7e89d-288">设置</span><span class="sxs-lookup"><span data-stu-id="7e89d-288">Settings</span></span></td></tr></table>


    <span data-ttu-id="7e89d-289">如果调用 removeHandlerAsync 方法时省略可选的 handler 参数, 则将删除指定的事件的所有事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="7e89d-289">If the optional handler parameter is omitted when calling the removeHandlerAsync method, all event handlers for the specified eventType will be removed.</span></span>


    <span data-ttu-id="7e89d-290">当执行传递给 callback 参数的函数时, 它会接收您可以从回调函数的唯一参数访问的 AsyncResult 对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-290">When the function you passed to the callback parameter executes, it receives an AsyncResult object that you can access from the callback function's only parameter.</span></span>


    <span data-ttu-id="7e89d-291">在传递给 removeHandlerAsync 方法的回调函数中, 您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class="sxs-lookup"><span data-stu-id="7e89d-291">In the callback function passed to the removeHandlerAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>


    <span data-ttu-id="7e89d-292">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="7e89d-292">**Support details**</span></span>


    <span data-ttu-id="7e89d-p119">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p119">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="7e89d-295">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class="sxs-lookup"><span data-stu-id="7e89d-295">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="7e89d-296">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="7e89d-296">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="7e89d-297">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="7e89d-297">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="7e89d-298">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="7e89d-298">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="7e89d-299">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="7e89d-299">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="7e89d-300"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-300"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-301">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-301">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id="7e89d-302"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-302"><strong> Excel </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-303">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-303">Y</span></span> </td><td> </td></tr> </table>
  name: removeHandlerAsync(eventType, options, callback)
  fullName: removeHandlerAsync(eventType, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, options?: RemoveHandlerOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: <span data-ttu-id="7e89d-p120">指定要移除事件的类型。必需。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p120">Specifies the type of event to remove. Required.</span></span>
      type:
      - Office.EventType
    - id: options
      description: <span data-ttu-id="7e89d-306">提供用于确定要删除的事件处理程序或处理程序的选项。</span><span class="sxs-lookup"><span data-stu-id="7e89d-306">Provides options to determine which event handler or handlers are removed.</span></span>
      type:
      - office.Office.RemoveHandlerOptions
    - id: callback
      description: <span data-ttu-id="7e89d-307">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-307">Optional.</span></span> <span data-ttu-id="7e89d-308">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-308">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.removeHandlerAsync_1
  summary: <span data-ttu-id="7e89d-309">删除 settingsChanged 事件的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="7e89d-309">Removes an event handler for the settingsChanged event.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"7e89d-310\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-310\">Requirement Sets</span></span></td><td><span data-ttu-id=\"7e89d-311\">设置</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-311\">Settings</span></span></td></tr></table>\n\n<span data-ttu-id=\"7e89d-312\">如果调用 removeHandlerAsync 方法时省略可选的 handler 参数, 则将删除指定的事件的所有事件处理程序。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-312\">If the optional handler parameter is omitted when calling the removeHandlerAsync method, all event handlers for the specified eventType will be removed.</span></span>\n\n<span data-ttu-id=\"7e89d-313\">当执行传递给 callback 参数的函数时, 它会接收您可以从回调函数的唯一参数访问的 AsyncResult 对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-313\">When the function you passed to the callback parameter executes, it receives an AsyncResult object that you can access from the callback function's only parameter.</span></span>\n\n<span data-ttu-id=\"7e89d-314\">在传递给 removeHandlerAsync 方法的回调函数中, 您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-314\">In the callback function passed to the removeHandlerAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>\n\n<span data-ttu-id=\"7e89d-315\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-315\">**Support details**</span></span>\n\n<span data-ttu-id=\"7e89d-p122\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-p122\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"7e89d-318\">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-318\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"7e89d-319\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-319\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"7e89d-320\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-320\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"7e89d-321\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-321\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"7e89d-322\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-322\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"7e89d-323\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-323\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"7e89d-324\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-324\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"7e89d-325\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-325\"><strong> Excel </strong></span></span></td><td> </td><td> <span data-ttu-id=\"7e89d-326\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-326\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"7e89d-327\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-327\">Examples</span></span>\n\n```javascript\nfunction removeSettingsChangedEventHandler() {\n    Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged, MyHandler);\n}\n\nfunction MyHandler(eventArgs) {\n    write('Event raised: ' + eventArgs.type);\n    doSomethingWithSettings(eventArgs.settings);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: removeHandlerAsync(eventType, callback)
  fullName: removeHandlerAsync(eventType, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: <span data-ttu-id="7e89d-p123">指定要移除事件的类型。必需。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p123">Specifies the type of event to remove. Required.</span></span>
      type:
      - Office.EventType
    - id: callback
      description: <span data-ttu-id="7e89d-330">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-330">Optional.</span></span> <span data-ttu-id="7e89d-331">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-331">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.saveAsync
  summary: <span data-ttu-id="7e89d-332">将设置属性包的内存副本保留到文档中。</span><span class="sxs-lookup"><span data-stu-id="7e89d-332">Persists the in-memory copy of the settings property bag in the document.</span></span>
  remarks: >-
    <span data-ttu-id="7e89d-p125">外接程序之前保存的所有设置都会在外接程序初始化时加载。因此，在会话的生存期内，你可以只使用 set 和 get 方法来处理设置属性包的内存中副本。如果你希望保留设置以便在下次使用外接程序时使用，请使用 saveAsync 方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p125">Any settings previously saved by an add-in are loaded when it is initialized, so during the lifetime of the session you can just use the set and get methods to work with the in-memory copy of the settings property bag. When you want to persist the settings so that they are available the next time the add-in is used, use the saveAsync method.</span></span>


    <span data-ttu-id="7e89d-335">**注意**: saveAsync 方法将内存中设置属性包保留到文档文件中。</span><span class="sxs-lookup"><span data-stu-id="7e89d-335">**Note**: The saveAsync method persists the in-memory settings property bag into the document file.</span></span> <span data-ttu-id="7e89d-336">但是, 仅当用户 (或自动恢复设置) 将文档保存到文件系统时, 对文档文件本身所做的更改才会保存。</span><span class="sxs-lookup"><span data-stu-id="7e89d-336">However, the changes to the document file itself are saved only when the user (or AutoRecover setting) saves the document to the file system.</span></span> <span data-ttu-id="7e89d-337">refreshAsync 方法仅在合著方案中非常有用。当同一加载项的其他实例可能会更改设置, 并且这些更改应对所有实例可用。</span><span class="sxs-lookup"><span data-stu-id="7e89d-337">The refreshAsync method is only useful in coauthoring scenarios when other instances of the same add-in might change the settings and those changes should be made available to all instances.</span></span>


    <table> <tr> <th><span data-ttu-id="7e89d-338">属性</span><span class="sxs-lookup"><span data-stu-id="7e89d-338">Property</span></span></th> <th><span data-ttu-id="7e89d-339">用于...</span><span class="sxs-lookup"><span data-stu-id="7e89d-339">Use to...</span></span></th> </tr> <tr> <td><span data-ttu-id="7e89d-340">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="7e89d-340">AsyncResult.value</span></span></td> <td><span data-ttu-id="7e89d-341">始终返回 undefined, 因为没有要检索的对象或数据。</span><span class="sxs-lookup"><span data-stu-id="7e89d-341">Always returns undefined because there is no object or data to retrieve.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-342">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="7e89d-342">AsyncResult.status</span></span></td> <td><span data-ttu-id="7e89d-343">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="7e89d-343">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-344">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="7e89d-344">AsyncResult.error</span></span></td> <td><span data-ttu-id="7e89d-345">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="7e89d-345">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="7e89d-346">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="7e89d-346">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="7e89d-347">在 AsyncResult 对象中未经改动的返回的任何类型的用户定义项。</span><span class="sxs-lookup"><span data-stu-id="7e89d-347">A user-defined item of any type that is returned in the AsyncResult object without being altered.</span></span></td> </tr> </table>


    <span data-ttu-id="7e89d-348">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="7e89d-348">**Support details**</span></span>


    <span data-ttu-id="7e89d-p127">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p127">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="7e89d-351">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class="sxs-lookup"><span data-stu-id="7e89d-351">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="7e89d-352">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="7e89d-352">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="7e89d-353">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="7e89d-353">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="7e89d-354">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="7e89d-354">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="7e89d-355">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="7e89d-355">Office for iPad</span></span> </th><th> <span data-ttu-id="7e89d-356">Office for Mac?</span><span class="sxs-lookup"><span data-stu-id="7e89d-356">Office for Mac</span></span> </th></tr> <tr><td><span data-ttu-id="7e89d-357"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-357"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-358">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-358">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id="7e89d-359"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-359"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="7e89d-360">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-360">Y</span></span> </td><td> <span data-ttu-id="7e89d-361">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-361">Y</span></span> </td><td> <span data-ttu-id="7e89d-362">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-362">Y</span></span> </td><td> <span data-ttu-id="7e89d-363">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-363">Y</span></span> </td></tr> <tr><td><span data-ttu-id="7e89d-364"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-364"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="7e89d-365">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-365">Y</span></span> </td><td> <span data-ttu-id="7e89d-366">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-366">Y</span></span> </td><td> <span data-ttu-id="7e89d-367">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-367">Y</span></span> </td><td> <span data-ttu-id="7e89d-368">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-368">Y</span></span> </td></tr> <tr><td><span data-ttu-id="7e89d-369"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-369"><strong> Word </strong></span></span></td><td> <span data-ttu-id="7e89d-370">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-370">Y</span></span> </td><td> <span data-ttu-id="7e89d-371">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-371">Y</span></span> </td><td> <span data-ttu-id="7e89d-372">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-372">Y</span></span> </td><td> <span data-ttu-id="7e89d-373">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-373">Y</span></span> </td></tr> </table>
  name: saveAsync(options, callback)
  fullName: saveAsync(options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'saveAsync(options?: SaveSettingsOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="7e89d-374">提供用于保存设置的选项。</span><span class="sxs-lookup"><span data-stu-id="7e89d-374">Provides options for saving settings.</span></span>
      type:
      - office.Office.SaveSettingsOptions
    - id: callback
      description: <span data-ttu-id="7e89d-375">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-375">Optional.</span></span> <span data-ttu-id="7e89d-376">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-376">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.saveAsync_1
  summary: <span data-ttu-id="7e89d-377">将设置属性包的内存副本保留到文档中。</span><span class="sxs-lookup"><span data-stu-id="7e89d-377">Persists the in-memory copy of the settings property bag in the document.</span></span>
  remarks: "<span data-ttu-id=\"7e89d-p129\">外接程序之前保存的所有设置都会在外接程序初始化时加载。因此，在会话的生存期内，你可以只使用 set 和 get 方法来处理设置属性包的内存中副本。如果你希望保留设置以便在下次使用外接程序时使用，请使用 saveAsync 方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-p129\">Any settings previously saved by an add-in are loaded when it is initialized, so during the lifetime of the session you can just use the set and get methods to work with the in-memory copy of the settings property bag. When you want to persist the settings so that they are available the next time the add-in is used, use the saveAsync method.</span></span>\n\n<span data-ttu-id=\"7e89d-380\">**注意**: saveAsync 方法将内存中设置属性包保留到文档文件中。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-380\">**Note**: The saveAsync method persists the in-memory settings property bag into the document file.</span></span> <span data-ttu-id=\"7e89d-381\">但是, 仅当用户 (或自动恢复设置) 将文档保存到文件系统时, 对文档文件本身所做的更改才会保存。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-381\">However, the changes to the document file itself are saved only when the user (or AutoRecover setting) saves the document to the file system.</span></span> <span data-ttu-id=\"7e89d-382\">refreshAsync 方法仅在合著方案中非常有用。当同一加载项的其他实例可能会更改设置, 并且这些更改应对所有实例可用。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-382\">The refreshAsync method is only useful in coauthoring scenarios when other instances of the same add-in might change the settings and those changes should be made available to all instances.</span></span>\n\n<table> <tr> <th><span data-ttu-id=\"7e89d-383\">属性</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-383\">Property</span></span></th> <th><span data-ttu-id=\"7e89d-384\">用于...</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-384\">Use to...</span></span></th> </tr> <tr> <td><span data-ttu-id=\"7e89d-385\">AsyncResult.value</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-385\">AsyncResult.value</span></span></td> <td><span data-ttu-id=\"7e89d-386\">始终返回 undefined, 因为没有要检索的对象或数据。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-386\">Always returns undefined because there is no object or data to retrieve.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"7e89d-387\">AsyncResult.status</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-387\">AsyncResult.status</span></span></td> <td><span data-ttu-id=\"7e89d-388\">确定操作是成功还是失败。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-388\">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"7e89d-389\">AsyncResult.error</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-389\">AsyncResult.error</span></span></td> <td><span data-ttu-id=\"7e89d-390\">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-390\">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"7e89d-391\">AsyncResult.asyncContext</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-391\">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id=\"7e89d-392\">在 AsyncResult 对象中未经改动的返回的任何类型的用户定义项。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-392\">A user-defined item of any type that is returned in the AsyncResult object without being altered.</span></span></td> </tr> </table>\n\n<span data-ttu-id=\"7e89d-393\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-393\">**Support details**</span></span>\n\n<span data-ttu-id=\"7e89d-p131\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-p131\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"7e89d-396\">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-396\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"7e89d-397\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-397\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"7e89d-398\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-398\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"7e89d-399\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-399\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"7e89d-400\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-400\">Office for iPad</span></span> </th><th> <span data-ttu-id=\"7e89d-401\">Office for Mac?</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-401\">Office for Mac</span></span> </th></tr> <tr><td><span data-ttu-id=\"7e89d-402\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-402\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"7e89d-403\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-403\">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id=\"7e89d-404\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-404\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"7e89d-405\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-405\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-406\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-406\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-407\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-407\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-408\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-408\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"7e89d-409\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-409\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"7e89d-410\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-410\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-411\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-411\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-412\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-412\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-413\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-413\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"7e89d-414\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-414\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"7e89d-415\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-415\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-416\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-416\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-417\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-417\">Y</span></span> </td><td> <span data-ttu-id=\"7e89d-418\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-418\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"7e89d-419\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"7e89d-419\">Examples</span></span>\n\n```javascript\nfunction persistSettings() {\n    Office.context.document.settings.saveAsync(function (asyncResult) {\n        write('Settings saved with status: ' + asyncResult.status);\n    });\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: saveAsync(callback)
  fullName: saveAsync(callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'saveAsync(callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: <span data-ttu-id="7e89d-420">可选。</span><span class="sxs-lookup"><span data-stu-id="7e89d-420">Optional.</span></span> <span data-ttu-id="7e89d-421">回调返回时调用的函数, 其唯一的参数的类型为 " [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->"。</span><span class="sxs-lookup"><span data-stu-id="7e89d-421">A function that is invoked when the callback returns, whose only parameter is of type [Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.set
  summary: >-
    <span data-ttu-id="7e89d-422">设置或创建指定设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-422">Sets or creates the specified setting.</span></span>


    <span data-ttu-id="7e89d-423">**重要说明**: 请注意, 设置方法仅影响设置属性包的内存中副本。</span><span class="sxs-lookup"><span data-stu-id="7e89d-423">**Important**: Be aware that the Settings.set method affects only the in-memory copy of the settings property bag.</span></span> <span data-ttu-id="7e89d-424">若要确保在下次打开文档时, 外接程序可以使用对设置的添加或更改, 请在调用 settings 方法并关闭外接程序之前的某个时刻, 必须调用 saveAsync 方法以保持文档中的设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-424">To make sure that additions or changes to settings will be available to your add-in the next time the document is opened, at some point after calling the Settings.set method and before the add-in is closed, you must call the Settings.saveAsync method to persist settings in the document.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="7e89d-425">要求集</span><span class="sxs-lookup"><span data-stu-id="7e89d-425">Requirement Sets</span></span></td><td><span data-ttu-id="7e89d-426">设置</span><span class="sxs-lookup"><span data-stu-id="7e89d-426">Settings</span></span></td></tr></table>


    <span data-ttu-id="7e89d-427">set 方法创建指定名称的新设置 (如果它尚不存在), 或在 settings 属性包的内存中副本中设置指定名称的现有设置。</span><span class="sxs-lookup"><span data-stu-id="7e89d-427">The set method creates a new setting of the specified name if it does not already exist, or sets an existing setting of the specified name in the in-memory copy of the settings property bag.</span></span> <span data-ttu-id="7e89d-428">调用 saveAsync 方法后, 该值将作为其数据类型的序列化 JSON 表示形式存储在文档中。</span><span class="sxs-lookup"><span data-stu-id="7e89d-428">After you call the Settings.saveAsync method, the value is stored in the document as the serialized JSON representation of its data type.</span></span> <span data-ttu-id="7e89d-429">每个加载项的设置最多可提供2mb。</span><span class="sxs-lookup"><span data-stu-id="7e89d-429">A maximum of 2MB is available for the settings of each add-in.</span></span>


    <span data-ttu-id="7e89d-430">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="7e89d-430">**Support details**</span></span>


    <span data-ttu-id="7e89d-p135">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="7e89d-p135">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="7e89d-433">有关 office 主机应用程序和服务器要求的详细信息, 请参阅[运行 office 外接](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->程序的要求。</span><span class="sxs-lookup"><span data-stu-id="7e89d-433">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="7e89d-434">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="7e89d-434">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="7e89d-435">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="7e89d-435">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="7e89d-436">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="7e89d-436">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="7e89d-437">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="7e89d-437">Office for iPad</span></span> </th><th> <span data-ttu-id="7e89d-438">Office for Mac?</span><span class="sxs-lookup"><span data-stu-id="7e89d-438">Office for Mac</span></span> </th></tr> <tr><td><span data-ttu-id="7e89d-439"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-439"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="7e89d-440">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-440">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id="7e89d-441"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-441"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="7e89d-442">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-442">Y</span></span> </td><td> <span data-ttu-id="7e89d-443">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-443">Y</span></span> </td><td> <span data-ttu-id="7e89d-444">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-444">Y</span></span> </td><td> <span data-ttu-id="7e89d-445">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-445">Y</span></span> </td></tr> <tr><td><span data-ttu-id="7e89d-446"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-446"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="7e89d-447">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-447">Y</span></span> </td><td> <span data-ttu-id="7e89d-448">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-448">Y</span></span> </td><td> <span data-ttu-id="7e89d-449">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-449">Y</span></span> </td><td> <span data-ttu-id="7e89d-450">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-450">Y</span></span> </td></tr> <tr><td><span data-ttu-id="7e89d-451"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="7e89d-451"><strong> Word </strong></span></span></td><td> <span data-ttu-id="7e89d-452">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-452">Y</span></span> </td><td> <span data-ttu-id="7e89d-453">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-453">Y</span></span> </td><td> <span data-ttu-id="7e89d-454">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-454">Y</span></span> </td><td> <span data-ttu-id="7e89d-455">Y</span><span class="sxs-lookup"><span data-stu-id="7e89d-455">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="7e89d-456">示例</span><span class="sxs-lookup"><span data-stu-id="7e89d-456">Examples</span></span>


    ```javascript

    function setMySetting() {
        Office.context.document.settings.set('mySetting', 'mySetting value');
    }

    ```
  name: set(name, value)
  fullName: set(name, value)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'set(name: string, value: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: ''
      type:
      - string
    - id: value
      description: <span data-ttu-id="7e89d-457">指定要存储的值。</span><span class="sxs-lookup"><span data-stu-id="7e89d-457">Specifies the value to be stored.</span></span>
      type:
      - any
