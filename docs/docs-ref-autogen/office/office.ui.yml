### YamlMime:UniversalReference
ms.openlocfilehash: cb4cce2896a75fb1f106b78b6f859cb17077f192
ms.sourcegitcommit: b0b614f5315ab2e5c1e0ea51c687498f87684a07
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/15/2019
ms.locfileid: "30056107"
items:
- uid: office.Office.UI
  summary: >-
    <span data-ttu-id="64fde-101">提供可用于在 Office 外接程序中创建和操作 UI 组件 (如对话框) 的对象和方法。</span><span class="sxs-lookup"><span data-stu-id="64fde-101">Provides objects and methods that you can use to create and manipulate UI components, such as dialog boxes, in your Office Add-ins.</span></span>


    <span data-ttu-id="64fde-102">有关详细信息, 请访问 "<!-- -->[在 Office 外接程序中使用对话框 API](https://docs.microsoft.com/office/dev/add-ins/develop/dialog-api-in-office-add-ins)"。</span><span class="sxs-lookup"><span data-stu-id="64fde-102">Visit "[Use the Dialog API in your Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/develop/dialog-api-in-office-add-ins)<!-- -->" for more information.</span></span>
  name: Office.UI
  fullName: Office.UI
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.UI.closeContainer
  - office.Office.UI.displayDialogAsync
  - office.Office.UI.displayDialogAsync_1
  - office.Office.UI.messageParent
- uid: office.Office.UI.closeContainer
  summary: <span data-ttu-id="64fde-103">关闭正在执行 JavaScript 的 UI 容器。</span><span class="sxs-lookup"><span data-stu-id="64fde-103">Closes the UI container where the JavaScript is executing.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="64fde-104">主机</span><span class="sxs-lookup"><span data-stu-id="64fde-104">Hosts</span></span></td><td><span data-ttu-id="64fde-105">Excel、Word、PowerPoint、Outlook (最低要求集: 邮箱 1.5)</span><span class="sxs-lookup"><span data-stu-id="64fde-105">Excel, Word, PowerPoint, Outlook (Minimum requirement set: Mailbox 1.5)</span></span></td></tr></table>


    <span data-ttu-id="64fde-106">此方法的行为由以下内容指定:</span><span class="sxs-lookup"><span data-stu-id="64fde-106">The behavior of this method is specified by the following:</span></span>


    - <span data-ttu-id="64fde-107">从无 UI 的命令按钮调用: 不起作用。</span><span class="sxs-lookup"><span data-stu-id="64fde-107">Called from a UI-less command button: No effect.</span></span> <span data-ttu-id="64fde-108">displayDialogAsync 打开的任何对话框将保持打开状态。</span><span class="sxs-lookup"><span data-stu-id="64fde-108">Any dialog opened by displayDialogAsync will remain open.</span></span>


    - <span data-ttu-id="64fde-109">从任务窗格调用: 任务窗格将关闭。</span><span class="sxs-lookup"><span data-stu-id="64fde-109">Called from a task pane: The task pane will close.</span></span> <span data-ttu-id="64fde-110">由 displayDialogAsync 打开的任何对话框也将关闭。</span><span class="sxs-lookup"><span data-stu-id="64fde-110">Any dialog opened by displayDialogAsync will also close.</span></span> <span data-ttu-id="64fde-111">如果任务窗格支持固定且由用户固定, 则它将被取消锁定。</span><span class="sxs-lookup"><span data-stu-id="64fde-111">If the task pane supports pinning and was pinned by the user, it will be un-pinned.</span></span>


    - <span data-ttu-id="64fde-112">从模块扩展中调用: 不起作用。</span><span class="sxs-lookup"><span data-stu-id="64fde-112">Called from a module extension: No effect.</span></span>
  name: closeContainer()
  fullName: closeContainer()
  langs:
  - typeScript
  type: method
  syntax:
    content: 'closeContainer(): void;'
    return:
      type:
      - void
      description: ''
- uid: office.Office.UI.displayDialogAsync
  summary: <span data-ttu-id="64fde-113">显示用于显示或收集用户信息或便于 Web 导航的对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-113">Displays a dialog to show or collect information from the user or to facilitate Web navigation.</span></span>
  remarks: >-
    <table> <tr><td><span data-ttu-id="64fde-114">主机</span><span class="sxs-lookup"><span data-stu-id="64fde-114">Hosts</span></span></td><td><span data-ttu-id="64fde-115">Word、Excel、Outlook、PowerPoint</span><span class="sxs-lookup"><span data-stu-id="64fde-115">Word, Excel, Outlook, PowerPoint</span></span></td></tr> <tr><td><span data-ttu-id="64fde-116">要求集</span><span class="sxs-lookup"><span data-stu-id="64fde-116">Requirement sets</span></span></td><td><span data-ttu-id="64fde-117">DialogAPI, 邮箱1。4</span><span class="sxs-lookup"><span data-stu-id="64fde-117">DialogAPI, Mailbox 1.4</span></span></td></tr> </table>


    <span data-ttu-id="64fde-118">此方法适用于 Word、Excel 或 PowerPoint 加载项的 DialogApi 要求集, 以及邮箱要求集 1.4 for Outlook。</span><span class="sxs-lookup"><span data-stu-id="64fde-118">This method is available in the DialogApi requirement set for Word, Excel, or PowerPoint add-ins, and in the Mailbox requirement set 1.4 for Outlook.</span></span> <span data-ttu-id="64fde-119">有关如何在清单中指定要求集的详细信息, 请参阅[指定 Office 主机和 API 要求](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="64fde-119">For more on how to specify a requirement set in your manifest, see [Specify Office hosts and API requirements](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)<!-- -->.</span></span>


    <span data-ttu-id="64fde-120">初始页必须与父页位于同一域中 (startAddress 参数)。</span><span class="sxs-lookup"><span data-stu-id="64fde-120">The initial page must be on the same domain as the parent page (the startAddress parameter).</span></span> <span data-ttu-id="64fde-121">初始网页加载后，你可以转到其他域。</span><span class="sxs-lookup"><span data-stu-id="64fde-121">After the initial page loads, you can go to other domains.</span></span>


    <span data-ttu-id="64fde-122">任何页调用`office.context.ui.messageParent`也必须与父页位于同一域中。</span><span class="sxs-lookup"><span data-stu-id="64fde-122">Any page calling `office.context.ui.messageParent` must also be on the same domain as the parent page.</span></span>


    <span data-ttu-id="64fde-123">**设计注意事项**:</span><span class="sxs-lookup"><span data-stu-id="64fde-123">**Design considerations**:</span></span>


    <span data-ttu-id="64fde-124">下列设计注意事项适用于对话框：</span><span class="sxs-lookup"><span data-stu-id="64fde-124">The following design considerations apply to dialog boxes:</span></span>


    - <span data-ttu-id="64fde-125">Office 外接程序任务窗格在任何时候都只能有一个打开的对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-125">An Office Add-in task pane can have only one dialog box open at any time.</span></span> <span data-ttu-id="64fde-126">可以从加载项命令同时打开多个对话框 (自定义功能区按钮或菜单项)。</span><span class="sxs-lookup"><span data-stu-id="64fde-126">Multiple dialogs can be open at the same time from Add-in Commands (custom ribbon buttons or menu items).</span></span>


    - <span data-ttu-id="64fde-127">用户可以移动每个对话框和调整其大小。</span><span class="sxs-lookup"><span data-stu-id="64fde-127">Every dialog box can be moved and resized by the user.</span></span>


    - <span data-ttu-id="64fde-128">每个对话框在打开时都在屏幕上居中显示。</span><span class="sxs-lookup"><span data-stu-id="64fde-128">Every dialog box is centered on the screen when opened.</span></span>


    - <span data-ttu-id="64fde-129">对话框按照创建的顺序出现在主机应用程序顶部。</span><span class="sxs-lookup"><span data-stu-id="64fde-129">Dialog boxes appear on top of the host application and in the order in which they were created.</span></span>


    <span data-ttu-id="64fde-130">使用对话框可以执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="64fde-130">Use a dialog box to:</span></span>


    - <span data-ttu-id="64fde-131">显示身份验证页以收集用户凭据。</span><span class="sxs-lookup"><span data-stu-id="64fde-131">Display authentication pages to collect user credentials.</span></span>


    - <span data-ttu-id="64fde-132">显示来自 ShowTaskpane 或 ExecuteAction 命令的错误/进度/输入屏幕。</span><span class="sxs-lookup"><span data-stu-id="64fde-132">Display an error/progress/input screen from a ShowTaskpane or ExecuteAction command.</span></span>


    - <span data-ttu-id="64fde-133">临时增加用户可用于完成一项任务的表面区域。</span><span class="sxs-lookup"><span data-stu-id="64fde-133">Temporarily increase the surface area that a user has available to complete a task.</span></span>


    <span data-ttu-id="64fde-p106">不要使用对话框与文档进行交互。而是使用任务窗格。</span><span class="sxs-lookup"><span data-stu-id="64fde-p106">Do not use a dialog box to interact with a document. Use a task pane instead.</span></span>


    <span data-ttu-id="64fde-136">有关可以用于创建对话框的设计模式，请参阅 GitHub 的 Office 外接程序 UX 设计模式存储库中的 [客户端对话框](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md)。</span><span class="sxs-lookup"><span data-stu-id="64fde-136">For a design pattern that you can use to create a dialog box, see [Client Dialog](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md) in the Office Add-in UX Design Patterns repository on GitHub.</span></span>


    <span data-ttu-id="64fde-137">**displayDialogAsync 错误**:</span><span class="sxs-lookup"><span data-stu-id="64fde-137">**displayDialogAsync Errors**:</span></span>


    <table> <tr> <th><span data-ttu-id="64fde-138">代码编号</span><span class="sxs-lookup"><span data-stu-id="64fde-138">Code number</span></span></th> <th><span data-ttu-id="64fde-139">含义</span><span class="sxs-lookup"><span data-stu-id="64fde-139">Meaning</span></span></th> </tr> <tr> <td><span data-ttu-id="64fde-140">12004</span><span class="sxs-lookup"><span data-stu-id="64fde-140">12004</span></span></td> <td><span data-ttu-id="64fde-141">传递给 displayDialogAsync 的 URL 的域不受信任。</span><span class="sxs-lookup"><span data-stu-id="64fde-141">The domain of the URL passed to displayDialogAsync is not trusted.</span></span> <span data-ttu-id="64fde-142">域必须与主机页位于同一域 (包括协议和端口号), 或者必须在加载项清单的<AppDomains>部分中进行注册。</span><span class="sxs-lookup"><span data-stu-id="64fde-142">The domain must be either the same domain as the host page (including protocol and port number), or it must be registered in the <AppDomains> section of the add-in manifest.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-143">12005</span><span class="sxs-lookup"><span data-stu-id="64fde-143">12005</span></span></td> <td><span data-ttu-id="64fde-144">传递给 displayDialogAsync 的 URL 使用 HTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="64fde-144">The URL passed to displayDialogAsync uses the HTTP protocol.</span></span> <span data-ttu-id="64fde-145">必须使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="64fde-145">HTTPS is required.</span></span> <span data-ttu-id="64fde-146">（在 Office 的某些版本中，返回 12005 的错误消息与返回 12004 错误消息是相同的。）</span><span class="sxs-lookup"><span data-stu-id="64fde-146">(In some versions of Office, the error message returned with 12005 is the same one returned for 12004.)</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-147">12007</span><span class="sxs-lookup"><span data-stu-id="64fde-147">12007</span></span></td> <td><span data-ttu-id="64fde-p109">从任务窗格已经打开了一个对话框。任务窗格外接程序一次只能打开一个对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-p109">A dialog box is already opened from the task pane. A task pane add-in can only have one dialog box open at a time.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-150">12009</span><span class="sxs-lookup"><span data-stu-id="64fde-150">12009</span></span></td> <td><span data-ttu-id="64fde-151">用户已选择忽略对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-151">The user chose to ignore the dialog box.</span></span> <span data-ttu-id="64fde-152">联机版本的 Office 中可能会发生此错误，用户可能会选择不允许加载项显示对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-152">This error can occur in online versions of Office, where users may choose not to allow an add-in to present a dialog.</span></span></td> </tr> </table>


    <span data-ttu-id="64fde-153">在传递给 displayDialogAsync 方法的回调函数中, 您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class="sxs-lookup"><span data-stu-id="64fde-153">In the callback function passed to the displayDialogAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>


    <table> <tr> <th><span data-ttu-id="64fde-154">属性</span><span class="sxs-lookup"><span data-stu-id="64fde-154">Property</span></span></th> <th><span data-ttu-id="64fde-155">用于</span><span class="sxs-lookup"><span data-stu-id="64fde-155">Use to</span></span></th> </tr> <tr> <td><span data-ttu-id="64fde-156">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="64fde-156">AsyncResult.value</span></span></td> <td><span data-ttu-id="64fde-157">访问 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="64fde-157">Access the Dialog object.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-158">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="64fde-158">AsyncResult.status</span></span></td> <td><span data-ttu-id="64fde-159">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="64fde-159">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-160">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="64fde-160">AsyncResult.error</span></span></td> <td><span data-ttu-id="64fde-161">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="64fde-161">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-162">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="64fde-162">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="64fde-163">如果你将用户定义的对象或值作为 asyncContext 参数传递，则对其进行访问。</span><span class="sxs-lookup"><span data-stu-id="64fde-163">Access your user-defined object or value, if you passed one as the asyncContext parameter.</span></span></td> </tr> </table>
  name: displayDialogAsync(startAddress, options, callback)
  fullName: displayDialogAsync(startAddress, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'displayDialogAsync(startAddress: string, options?: DialogOptions, callback?: (result: AsyncResult<Dialog>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: startAddress
      description: <span data-ttu-id="64fde-164">接受在对话框中打开的初始 HTTPS URL。</span><span class="sxs-lookup"><span data-stu-id="64fde-164">Accepts the initial HTTPS URL that opens in the dialog.</span></span>
      type:
      - string
    - id: options
      description: <span data-ttu-id="64fde-165">可选。</span><span class="sxs-lookup"><span data-stu-id="64fde-165">Optional.</span></span> <span data-ttu-id="64fde-166">接受[DialogOptions](xref:office.Office.DialogOptions)对象以定义对话框显示。</span><span class="sxs-lookup"><span data-stu-id="64fde-166">Accepts an [Office.DialogOptions](xref:office.Office.DialogOptions) object to define dialog display.</span></span>
      type:
      - office.Office.DialogOptions
    - id: callback
      description: <span data-ttu-id="64fde-167">可选。</span><span class="sxs-lookup"><span data-stu-id="64fde-167">Optional.</span></span> <span data-ttu-id="64fde-168">接受用于处理对话框创建尝试的 callback 方法。</span><span class="sxs-lookup"><span data-stu-id="64fde-168">Accepts a callback method to handle the dialog creation attempt.</span></span> <span data-ttu-id="64fde-169">如果成功, AsyncResult 的值是 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="64fde-169">If successful, the AsyncResult.value is a Dialog object.</span></span>
      type:
      - '(result: AsyncResult<Dialog>) => void'
- uid: office.Office.UI.displayDialogAsync_1
  summary: <span data-ttu-id="64fde-170">显示用于显示或收集用户信息或便于 Web 导航的对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-170">Displays a dialog to show or collect information from the user or to facilitate Web navigation.</span></span>
  remarks: >-
    <table> <tr><td><span data-ttu-id="64fde-171">主机</span><span class="sxs-lookup"><span data-stu-id="64fde-171">Hosts</span></span></td><td><span data-ttu-id="64fde-172">Word、Excel、Outlook、PowerPoint</span><span class="sxs-lookup"><span data-stu-id="64fde-172">Word, Excel, Outlook, PowerPoint</span></span></td></tr> <tr><td><span data-ttu-id="64fde-173">要求集</span><span class="sxs-lookup"><span data-stu-id="64fde-173">Requirement sets</span></span></td><td><span data-ttu-id="64fde-174">DialogAPI, 邮箱1。4</span><span class="sxs-lookup"><span data-stu-id="64fde-174">DialogAPI, Mailbox 1.4</span></span></td></tr> </table>


    <span data-ttu-id="64fde-175">此方法适用于 Word、Excel 或 PowerPoint 加载项的 DialogApi 要求集, 以及邮箱要求集 1.4 for Outlook。</span><span class="sxs-lookup"><span data-stu-id="64fde-175">This method is available in the DialogApi requirement set for Word, Excel, or PowerPoint add-ins, and in the Mailbox requirement set 1.4 for Outlook.</span></span> <span data-ttu-id="64fde-176">有关如何在清单中指定要求集的详细信息, 请参阅[指定 Office 主机和 API 要求](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="64fde-176">For more on how to specify a requirement set in your manifest, see [Specify Office hosts and API requirements](https://docs.microsoft.com/office/dev/add-ins/develop/specify-office-hosts-and-api-requirements)<!-- -->.</span></span>


    <span data-ttu-id="64fde-177">初始页必须与父页位于同一域中 (startAddress 参数)。</span><span class="sxs-lookup"><span data-stu-id="64fde-177">The initial page must be on the same domain as the parent page (the startAddress parameter).</span></span> <span data-ttu-id="64fde-178">初始网页加载后，你可以转到其他域。</span><span class="sxs-lookup"><span data-stu-id="64fde-178">After the initial page loads, you can go to other domains.</span></span>


    <span data-ttu-id="64fde-179">任何页调用`office.context.ui.messageParent`也必须与父页位于同一域中。</span><span class="sxs-lookup"><span data-stu-id="64fde-179">Any page calling `office.context.ui.messageParent` must also be on the same domain as the parent page.</span></span>


    <span data-ttu-id="64fde-180">**设计注意事项**:</span><span class="sxs-lookup"><span data-stu-id="64fde-180">**Design considerations**:</span></span>


    <span data-ttu-id="64fde-181">下列设计注意事项适用于对话框：</span><span class="sxs-lookup"><span data-stu-id="64fde-181">The following design considerations apply to dialog boxes:</span></span>


    - <span data-ttu-id="64fde-182">Office 外接程序任务窗格在任何时候都只能有一个打开的对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-182">An Office Add-in task pane can have only one dialog box open at any time.</span></span> <span data-ttu-id="64fde-183">可以从加载项命令同时打开多个对话框 (自定义功能区按钮或菜单项)。</span><span class="sxs-lookup"><span data-stu-id="64fde-183">Multiple dialogs can be open at the same time from Add-in Commands (custom ribbon buttons or menu items).</span></span>


    - <span data-ttu-id="64fde-184">用户可以移动每个对话框和调整其大小。</span><span class="sxs-lookup"><span data-stu-id="64fde-184">Every dialog box can be moved and resized by the user.</span></span>


    - <span data-ttu-id="64fde-185">每个对话框在打开时都在屏幕上居中显示。</span><span class="sxs-lookup"><span data-stu-id="64fde-185">Every dialog box is centered on the screen when opened.</span></span>


    - <span data-ttu-id="64fde-186">对话框按照创建的顺序出现在主机应用程序顶部。</span><span class="sxs-lookup"><span data-stu-id="64fde-186">Dialog boxes appear on top of the host application and in the order in which they were created.</span></span>


    <span data-ttu-id="64fde-187">使用对话框可以执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="64fde-187">Use a dialog box to:</span></span>


    - <span data-ttu-id="64fde-188">显示身份验证页以收集用户凭据。</span><span class="sxs-lookup"><span data-stu-id="64fde-188">Display authentication pages to collect user credentials.</span></span>


    - <span data-ttu-id="64fde-189">显示来自 ShowTaskpane 或 ExecuteAction 命令的错误/进度/输入屏幕。</span><span class="sxs-lookup"><span data-stu-id="64fde-189">Display an error/progress/input screen from a ShowTaskpane or ExecuteAction command.</span></span>


    - <span data-ttu-id="64fde-190">临时增加用户可用于完成一项任务的表面区域。</span><span class="sxs-lookup"><span data-stu-id="64fde-190">Temporarily increase the surface area that a user has available to complete a task.</span></span>


    <span data-ttu-id="64fde-p116">不要使用对话框与文档进行交互。而是使用任务窗格。</span><span class="sxs-lookup"><span data-stu-id="64fde-p116">Do not use a dialog box to interact with a document. Use a task pane instead.</span></span>


    <span data-ttu-id="64fde-193">有关可以用于创建对话框的设计模式，请参阅 GitHub 的 Office 外接程序 UX 设计模式存储库中的 [客户端对话框](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md)。</span><span class="sxs-lookup"><span data-stu-id="64fde-193">For a design pattern that you can use to create a dialog box, see [Client Dialog](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md) in the Office Add-in UX Design Patterns repository on GitHub.</span></span>


    <span data-ttu-id="64fde-194">**displayDialogAsync 错误**:</span><span class="sxs-lookup"><span data-stu-id="64fde-194">**displayDialogAsync Errors**:</span></span>


    <table> <tr> <th><span data-ttu-id="64fde-195">代码编号</span><span class="sxs-lookup"><span data-stu-id="64fde-195">Code number</span></span></th> <th><span data-ttu-id="64fde-196">含义</span><span class="sxs-lookup"><span data-stu-id="64fde-196">Meaning</span></span></th> </tr> <tr> <td><span data-ttu-id="64fde-197">12004</span><span class="sxs-lookup"><span data-stu-id="64fde-197">12004</span></span></td> <td><span data-ttu-id="64fde-198">传递给 displayDialogAsync 的 URL 的域不受信任。</span><span class="sxs-lookup"><span data-stu-id="64fde-198">The domain of the URL passed to displayDialogAsync is not trusted.</span></span> <span data-ttu-id="64fde-199">域必须与主机页位于同一域 (包括协议和端口号), 或者必须在加载项清单的<AppDomains>部分中进行注册。</span><span class="sxs-lookup"><span data-stu-id="64fde-199">The domain must be either the same domain as the host page (including protocol and port number), or it must be registered in the <AppDomains> section of the add-in manifest.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-200">12005</span><span class="sxs-lookup"><span data-stu-id="64fde-200">12005</span></span></td> <td><span data-ttu-id="64fde-201">传递给 displayDialogAsync 的 URL 使用 HTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="64fde-201">The URL passed to displayDialogAsync uses the HTTP protocol.</span></span> <span data-ttu-id="64fde-202">必须使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="64fde-202">HTTPS is required.</span></span> <span data-ttu-id="64fde-203">（在 Office 的某些版本中，返回 12005 的错误消息与返回 12004 错误消息是相同的。）</span><span class="sxs-lookup"><span data-stu-id="64fde-203">(In some versions of Office, the error message returned with 12005 is the same one returned for 12004.)</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-204">12007</span><span class="sxs-lookup"><span data-stu-id="64fde-204">12007</span></span></td> <td><span data-ttu-id="64fde-p119">从任务窗格已经打开了一个对话框。任务窗格外接程序一次只能打开一个对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-p119">A dialog box is already opened from the task pane. A task pane add-in can only have one dialog box open at a time.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-207">12009</span><span class="sxs-lookup"><span data-stu-id="64fde-207">12009</span></span></td> <td><span data-ttu-id="64fde-208">用户已选择忽略对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-208">The user chose to ignore the dialog box.</span></span> <span data-ttu-id="64fde-209">联机版本的 Office 中可能会发生此错误，用户可能会选择不允许加载项显示对话框。</span><span class="sxs-lookup"><span data-stu-id="64fde-209">This error can occur in online versions of Office, where users may choose not to allow an add-in to present a dialog.</span></span></td> </tr> </table>


    <span data-ttu-id="64fde-210">在传递给 displayDialogAsync 方法的回调函数中, 您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class="sxs-lookup"><span data-stu-id="64fde-210">In the callback function passed to the displayDialogAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>


    <table> <tr> <th><span data-ttu-id="64fde-211">属性</span><span class="sxs-lookup"><span data-stu-id="64fde-211">Property</span></span></th> <th><span data-ttu-id="64fde-212">用于</span><span class="sxs-lookup"><span data-stu-id="64fde-212">Use to</span></span></th> </tr> <tr> <td><span data-ttu-id="64fde-213">AsyncResult.value</span><span class="sxs-lookup"><span data-stu-id="64fde-213">AsyncResult.value</span></span></td> <td><span data-ttu-id="64fde-214">访问 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="64fde-214">Access the Dialog object.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-215">AsyncResult.status</span><span class="sxs-lookup"><span data-stu-id="64fde-215">AsyncResult.status</span></span></td> <td><span data-ttu-id="64fde-216">确定操作是成功还是失败。</span><span class="sxs-lookup"><span data-stu-id="64fde-216">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-217">AsyncResult.error</span><span class="sxs-lookup"><span data-stu-id="64fde-217">AsyncResult.error</span></span></td> <td><span data-ttu-id="64fde-218">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class="sxs-lookup"><span data-stu-id="64fde-218">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id="64fde-219">AsyncResult.asyncContext</span><span class="sxs-lookup"><span data-stu-id="64fde-219">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id="64fde-220">如果你将用户定义的对象或值作为 asyncContext 参数传递，则对其进行访问。</span><span class="sxs-lookup"><span data-stu-id="64fde-220">Access your user-defined object or value, if you passed one as the asyncContext parameter.</span></span></td> </tr> </table>
  name: displayDialogAsync(startAddress, callback)
  fullName: displayDialogAsync(startAddress, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'displayDialogAsync(startAddress: string, callback?: (result: AsyncResult<Dialog>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: startAddress
      description: <span data-ttu-id="64fde-221">接受在对话框中打开的初始 HTTPS URL。</span><span class="sxs-lookup"><span data-stu-id="64fde-221">Accepts the initial HTTPS URL that opens in the dialog.</span></span>
      type:
      - string
    - id: callback
      description: <span data-ttu-id="64fde-222">可选。</span><span class="sxs-lookup"><span data-stu-id="64fde-222">Optional.</span></span> <span data-ttu-id="64fde-223">接受用于处理对话框创建尝试的 callback 方法。</span><span class="sxs-lookup"><span data-stu-id="64fde-223">Accepts a callback method to handle the dialog creation attempt.</span></span> <span data-ttu-id="64fde-224">如果成功, AsyncResult 的值是 Dialog 对象。</span><span class="sxs-lookup"><span data-stu-id="64fde-224">If successful, the AsyncResult.value is a Dialog object.</span></span>
      type:
      - '(result: AsyncResult<Dialog>) => void'
- uid: office.Office.UI.messageParent
  summary: <span data-ttu-id="64fde-p122">将对话框中的消息传送到其父页/开始页。调用此 API 的页必须与父页位于相同的域。</span><span class="sxs-lookup"><span data-stu-id="64fde-p122">Delivers a message from the dialog box to its parent/opener page. The page calling this API must be on the same domain as the parent.</span></span>
  name: messageParent(message)
  fullName: messageParent(message)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'messageParent(message: boolean | string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: message
      description: <span data-ttu-id="64fde-227">接受从对话框传送到外接程序的消息。</span><span class="sxs-lookup"><span data-stu-id="64fde-227">Accepts a message from the dialog to deliver to the add-in.</span></span> <span data-ttu-id="64fde-228">除了布尔值之外, 可以将任何可序列化为字符串的任何内容 (包括 JSON 和 XML) 都可以发送。</span><span class="sxs-lookup"><span data-stu-id="64fde-228">In addition to a boolean, anything that can serialized to a string including JSON and XML can be sent.</span></span>
      type:
      - boolean | string
