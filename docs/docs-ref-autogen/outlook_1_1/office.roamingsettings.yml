### YamlMime:UniversalReference
ms.openlocfilehash: 76ba90e68e4df524fdd7234b2365d5dbd7a666cc
ms.sourcegitcommit: 6c48441b8be51d3a9d7dc836e386230a155feceb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/22/2019
ms.locfileid: "30198828"
items:
- uid: Outlook_1_1.Office.RoamingSettings
  summary: >-
    <span data-ttu-id="c3d28-p101">通过使用 RoamingSettings 对象的方法创建的设置将按外接程序和按用户进行保存，即，这些设置仅供创建它们的外接程序使用，并且仅来自保存它们的用户邮箱。</span><span class="sxs-lookup"><span data-stu-id="c3d28-p101">The settings created by using the methods of the RoamingSettings object are saved per add-in and per user. That is, they are available only to the add-in that created them, and only from the user's mail box in which they are saved.</span></span>


    <span data-ttu-id="c3d28-p102">虽然 Outlook 外接程序 API 仅允许创建它们的外接程序访问这些设置，但这些设置不应被视为安全存储。可以通过 Exchange Web 服务或扩展 MAPI 访问这些设置。它们不应用于存储敏感信息，如用户凭据或安全令牌。</span><span class="sxs-lookup"><span data-stu-id="c3d28-p102">While the Outlook Add-in API limits access to these settings to only the add-in that created them, these settings should not be considered secure storage. They can be accessed by Exchange Web Services or Extended MAPI. They should not be used to store sensitive information such as user credentials or security tokens.</span></span>


    <span data-ttu-id="c3d28-106">设置的名称是一个字符串，而值可以是字符串、数字、布尔值、null 值、对象或数组。</span><span class="sxs-lookup"><span data-stu-id="c3d28-106">The name of a setting is a String, while the value can be a String, Number, Boolean, null, Object, or Array.</span></span>


    <span data-ttu-id="c3d28-107">可通过 Office.context 命名空间中的 roamingSettings 属性访问 RoamingSettings 对象。</span><span class="sxs-lookup"><span data-stu-id="c3d28-107">The RoamingSettings object is accessible via the roamingSettings property in the Office.context namespace.</span></span>


    <span data-ttu-id="c3d28-108">**重要说明**: 只有在首次加载加载项时, 才会从持久化存储初始化 RoamingSettings 对象。</span><span class="sxs-lookup"><span data-stu-id="c3d28-108">**Important**: The RoamingSettings object is initialized from the persisted storage only when the add-in is first loaded.</span></span> <span data-ttu-id="c3d28-109">对于任务窗格, 这意味着仅在第一次打开任务窗格时才会对其进行初始化。</span><span class="sxs-lookup"><span data-stu-id="c3d28-109">For task panes, this means that it is only initialized when the task pane first opens.</span></span> <span data-ttu-id="c3d28-110">如果任务窗格导航到另一个页面或重新加载当前页面, 则内存中的对象将重置为其初始值, 即使您的外接程序具有持续的更改也是如此。</span><span class="sxs-lookup"><span data-stu-id="c3d28-110">If the task pane navigates to another page or reloads the current page, the in-memory object is reset to its initial values, even if your add-in has persisted changes.</span></span> <span data-ttu-id="c3d28-111">在关闭并重新打开任务窗格之前, 保留的更改将不可用。</span><span class="sxs-lookup"><span data-stu-id="c3d28-111">The persisted changes will not be available until the task pane is closed and reopened.</span></span>


    <span data-ttu-id="c3d28-112">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="c3d28-112">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table> <tr><td>[<span data-ttu-id="c3d28-113">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="c3d28-113">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="c3d28-114">受限</span><span class="sxs-lookup"><span data-stu-id="c3d28-114">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="c3d28-115">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="c3d28-115">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="c3d28-116">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="c3d28-116">Compose or Read</span></span></td></tr> </table><span data-ttu-id="c3d28-117">

    ####说明</span><span class="sxs-lookup"><span data-stu-id="c3d28-117">

    #### Examples</span></span>


    ```javascript

    // Get the current value of the 'myKey' setting.

    var value = Office.context.roamingSettings.get('myKey');

    // Update the value of the 'myKey' setting.

    Office.context.roamingSettings.set('myKey', 'Hello World!');

    // Persist the change.

    Office.context.roamingSettings.saveAsync();

    ```
  name: Office.RoamingSettings
  fullName: Office.RoamingSettings
  langs:
  - typeScript
  type: interface
  package: Outlook_1_1
  children:
  - Outlook_1_1.Office.RoamingSettings.get
  - Outlook_1_1.Office.RoamingSettings.remove
  - Outlook_1_1.Office.RoamingSettings.saveAsync
  - Outlook_1_1.Office.RoamingSettings.set
- uid: Outlook_1_1.Office.RoamingSettings.get
  summary: >-
    <span data-ttu-id="c3d28-118">检索指定设置。</span><span class="sxs-lookup"><span data-stu-id="c3d28-118">Retrieves the specified setting.</span></span>


    <span data-ttu-id="c3d28-119">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="c3d28-119">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="c3d28-120">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="c3d28-120">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="c3d28-121">受限</span><span class="sxs-lookup"><span data-stu-id="c3d28-121">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="c3d28-122">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="c3d28-122">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="c3d28-123">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="c3d28-123">Compose or Read</span></span></td></tr> </table>
  name: get(name)
  fullName: get(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'get(name: string): any;'
    return:
      type:
      - any
      description: '<span data-ttu-id="c3d28-124">类型: String \| Number \| Boolean \|对象\|数组</span><span class="sxs-lookup"><span data-stu-id="c3d28-124">Type: String \| Number \| Boolean \| Object \| Array</span></span>'
    parameters:
    - id: name
      description: <span data-ttu-id="c3d28-125">要检索的设置的区分大小写的名称。</span><span class="sxs-lookup"><span data-stu-id="c3d28-125">The case-sensitive name of the setting to retrieve.</span></span>
      type:
      - string
- uid: Outlook_1_1.Office.RoamingSettings.remove
  summary: >-
    <span data-ttu-id="c3d28-126">删除指定的设置</span><span class="sxs-lookup"><span data-stu-id="c3d28-126">Removes the specified setting</span></span>


    <span data-ttu-id="c3d28-127">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="c3d28-127">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="c3d28-128">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="c3d28-128">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="c3d28-129">受限</span><span class="sxs-lookup"><span data-stu-id="c3d28-129">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="c3d28-130">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="c3d28-130">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="c3d28-131">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="c3d28-131">Compose or Read</span></span></td></tr> </table>
  name: remove(name)
  fullName: remove(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'remove(name: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: <span data-ttu-id="c3d28-132">要移除的设置的区分大小写的名称。</span><span class="sxs-lookup"><span data-stu-id="c3d28-132">The case-sensitive name of the setting to remove.</span></span>
      type:
      - string
- uid: Outlook_1_1.Office.RoamingSettings.saveAsync
  summary: >-
    <span data-ttu-id="c3d28-133">保存设置。</span><span class="sxs-lookup"><span data-stu-id="c3d28-133">Saves the settings.</span></span>


    <span data-ttu-id="c3d28-p104">外接程序初始化时会加载之前保存的所有设置，因此，在会话的生存期内，您只能通过 set 和 get 方法使用设置属性包的内存副本。如果希望保留该设置以便可在下次使用外接程序时使用这些设置，请使用 saveAsync 方法。</span><span class="sxs-lookup"><span data-stu-id="c3d28-p104">Any settings previously saved by an add-in are loaded when it is initialized, so during the lifetime of the session you can just use the set and get methods to work with the in-memory copy of the settings property bag. When you want to persist the settings so that they are available the next time the add-in is used, use the saveAsync method.</span></span>


    <span data-ttu-id="c3d28-136">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="c3d28-136">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="c3d28-137">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="c3d28-137">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="c3d28-138">受限</span><span class="sxs-lookup"><span data-stu-id="c3d28-138">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="c3d28-139">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="c3d28-139">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="c3d28-140">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="c3d28-140">Compose or Read</span></span></td></tr> </table>
  name: saveAsync(callback)
  fullName: saveAsync(callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'saveAsync(callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: <span data-ttu-id="c3d28-141">可选。</span><span class="sxs-lookup"><span data-stu-id="c3d28-141">Optional.</span></span> <span data-ttu-id="c3d28-142">方法完成后, 将使用类型为 AsyncResult 的单个参数调用在 callback 参数中传递的函数。</span><span class="sxs-lookup"><span data-stu-id="c3d28-142">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span>
      type:
      - '(asyncResult: Office.AsyncResult<void>) => void'
- uid: Outlook_1_1.Office.RoamingSettings.set
  summary: >-
    <span data-ttu-id="c3d28-143">设置或创建指定设置。</span><span class="sxs-lookup"><span data-stu-id="c3d28-143">Sets or creates the specified setting.</span></span>


    <span data-ttu-id="c3d28-p106">set 方法创建指定名称的新设置（如果该设置尚不存在），或者设置指定名称的现有设置。该值在文档中存储为其数据类型的序列化 JSON 表示形式。</span><span class="sxs-lookup"><span data-stu-id="c3d28-p106">The set method creates a new setting of the specified name if it does not already exist, or sets an existing setting of the specified name. The value is stored in the document as the serialized JSON representation of its data type.</span></span>


    <span data-ttu-id="c3d28-146">每个加载项的设置最多可使用32KB。</span><span class="sxs-lookup"><span data-stu-id="c3d28-146">A maximum of 32KB is available for the settings of each add-in.</span></span>


    <span data-ttu-id="c3d28-147">在调用 saveAsync 函数之前，使用 set 函数对设置所做的所有更改将不会保存到服务器。</span><span class="sxs-lookup"><span data-stu-id="c3d28-147">Any changes made to settings using the set function will not be saved to the server until the saveAsync function is called.</span></span>


    <span data-ttu-id="c3d28-148">\[[API 集: 邮箱 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="c3d28-148">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="c3d28-149">最低权限级别</span><span class="sxs-lookup"><span data-stu-id="c3d28-149">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="c3d28-150">受限</span><span class="sxs-lookup"><span data-stu-id="c3d28-150">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="c3d28-151">适用的 Outlook 模式</span><span class="sxs-lookup"><span data-stu-id="c3d28-151">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="c3d28-152">撰写或阅读</span><span class="sxs-lookup"><span data-stu-id="c3d28-152">Compose or Read</span></span></td></tr> </table>
  name: set(name, value)
  fullName: set(name, value)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'set(name: string, value: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: <span data-ttu-id="c3d28-153">要设置或创建的设置的名称（区分大小写）。</span><span class="sxs-lookup"><span data-stu-id="c3d28-153">The case-sensitive name of the setting to set or create.</span></span>
      type:
      - string
    - id: value
      description: <span data-ttu-id="c3d28-154">指定要存储的值。</span><span class="sxs-lookup"><span data-stu-id="c3d28-154">Specifies the value to be stored.</span></span>
      type:
      - any
