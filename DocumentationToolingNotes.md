# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="dc9df-101">Office JavaScript API 文档的生成方式</span><span class="sxs-lookup"><span data-stu-id="dc9df-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="dc9df-102">Office JavaScript 参考文档页面由类型定义文件和示例代码段生成。</span><span class="sxs-lookup"><span data-stu-id="dc9df-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="dc9df-103">此过程使用开放源工具和存储库特定的脚本的混合。</span><span class="sxs-lookup"><span data-stu-id="dc9df-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="dc9df-104">本文档旨在使此存储库的过程透明，以便社区能够更好地利用和参与此内容。</span><span class="sxs-lookup"><span data-stu-id="dc9df-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="dc9df-105">内容源</span><span class="sxs-lookup"><span data-stu-id="dc9df-105">Content sources</span></span>

<span data-ttu-id="dc9df-106">组合两种类型的内容以创建 Office JS 参考文档：类型定义和代码段。</span><span class="sxs-lookup"><span data-stu-id="dc9df-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="dc9df-107">这些确保了完整的 API 覆盖率并提供了小型的内联代码示例。</span><span class="sxs-lookup"><span data-stu-id="dc9df-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="dc9df-108">类型定义文件</span><span class="sxs-lookup"><span data-stu-id="dc9df-108">Type definition files</span></span>

<span data-ttu-id="dc9df-109">[绝对键入](https://github.com/DefinitelyTyped/DefinitelyTyped)的类型定义文件是文档的唯一事实来源。</span><span class="sxs-lookup"><span data-stu-id="dc9df-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="dc9df-110">使用这些类型定义文件的使用 TypeScript 编译的任何 Office 外接程序。</span><span class="sxs-lookup"><span data-stu-id="dc9df-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="dc9df-111">这些功能还提供 JavaScript 和 TypeScript 开发人员 IntelliSense 功能。</span><span class="sxs-lookup"><span data-stu-id="dc9df-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="dc9df-112">通过生成这些定义中的参考文档，我们可以提供更准确的信息。</span><span class="sxs-lookup"><span data-stu-id="dc9df-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="dc9df-113">共有四个相关的 d ts 文件，它们提供文档不同子部分的源内容。</span><span class="sxs-lookup"><span data-stu-id="dc9df-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="dc9df-114">[office-js/索引](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts)（发布定义）。</span><span class="sxs-lookup"><span data-stu-id="dc9df-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="dc9df-115">Excel （发布）</span><span class="sxs-lookup"><span data-stu-id="dc9df-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="dc9df-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="dc9df-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="dc9df-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="dc9df-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="dc9df-118">Visio</span><span class="sxs-lookup"><span data-stu-id="dc9df-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="dc9df-119">Word （发布）</span><span class="sxs-lookup"><span data-stu-id="dc9df-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="dc9df-120">通用 API 的 OfficeExtensions 子部分</span><span class="sxs-lookup"><span data-stu-id="dc9df-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="dc9df-121">[office-js-预览/索引](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts)（预览定义）。</span><span class="sxs-lookup"><span data-stu-id="dc9df-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="dc9df-122">Excel （预览）</span><span class="sxs-lookup"><span data-stu-id="dc9df-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="dc9df-123">Outlook （预览）</span><span class="sxs-lookup"><span data-stu-id="dc9df-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="dc9df-124">Word （预览）</span><span class="sxs-lookup"><span data-stu-id="dc9df-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="dc9df-125">通用 API</span><span class="sxs-lookup"><span data-stu-id="dc9df-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="dc9df-126">[自定义函数-运行时](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts)（Excel 自定义函数运行时定义。）</span><span class="sxs-lookup"><span data-stu-id="dc9df-126">[custom-functions-runtime](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts)(The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="dc9df-127">自定义函数</span><span class="sxs-lookup"><span data-stu-id="dc9df-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="dc9df-128">[office 运行时](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts)（自定义函数平台的 office 运行时定义。）</span><span class="sxs-lookup"><span data-stu-id="dc9df-128">[office-runtime](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts)(The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="dc9df-129">Office 运行时</span><span class="sxs-lookup"><span data-stu-id="dc9df-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="dc9df-130">较旧版本的 Api 具有它们自己的 d ts 文件。</span><span class="sxs-lookup"><span data-stu-id="dc9df-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="dc9df-131">当发布新的 API 要求集时，将保留这些设置。</span><span class="sxs-lookup"><span data-stu-id="dc9df-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="dc9df-132">也可以使用[版本 Remover 工具](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts)生成。</span><span class="sxs-lookup"><span data-stu-id="dc9df-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="dc9df-133">保留这些旧的 d .aspx 文件，以便在对事件 Api 进行修补或更改时，仍会记录原始行为。</span><span class="sxs-lookup"><span data-stu-id="dc9df-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="dc9df-134">如果您必须针对较旧版本的 API，这将非常有用。</span><span class="sxs-lookup"><span data-stu-id="dc9df-134">This is useful if you have to target an older version of the API.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="dc9df-135">代码段</span><span class="sxs-lookup"><span data-stu-id="dc9df-135">Code snippets</span></span>

<span data-ttu-id="dc9df-136">代码示例代码段将添加到以下两个源中的参考页面：</span><span class="sxs-lookup"><span data-stu-id="dc9df-136">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="dc9df-137">脚本实验室示例</span><span class="sxs-lookup"><span data-stu-id="dc9df-137">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="dc9df-138">本地代码段</span><span class="sxs-lookup"><span data-stu-id="dc9df-138">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="dc9df-139">本地代码段位于特定于主机的 yaml 文件中。</span><span class="sxs-lookup"><span data-stu-id="dc9df-139">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="dc9df-140">其内容按类和字段进行组织，以便可以将其映射到参考页中的适当位置。</span><span class="sxs-lookup"><span data-stu-id="dc9df-140">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="dc9df-141">使用 await 语句可推断代码段（JavaScript 或 TypeScript）的语言。</span><span class="sxs-lookup"><span data-stu-id="dc9df-141">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="dc9df-142">脚本实验室代码段是从工作示例中提取的。</span><span class="sxs-lookup"><span data-stu-id="dc9df-142">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="dc9df-143">目前，Excel 和 Word 示例通过一[对映射文件](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata)映射到参考文档部分。</span><span class="sxs-lookup"><span data-stu-id="dc9df-143">Currently, Excel and Word samples are mapped to reference document sections through a [pair of mapping files](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span></span> <span data-ttu-id="dc9df-144">这些方法将各个示例方法与 API 中的属性或方法相匹配。</span><span class="sxs-lookup"><span data-stu-id="dc9df-144">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="dc9df-145">在`yarn start`运行 office js 存储库时，将创建一个包含所有已映射代码段的[yaml 文件](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml)。</span><span class="sxs-lookup"><span data-stu-id="dc9df-145">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="dc9df-146">此 yaml 文件是参考文档工具中的输入。</span><span class="sxs-lookup"><span data-stu-id="dc9df-146">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="dc9df-147">刀具管道</span><span class="sxs-lookup"><span data-stu-id="dc9df-147">Tooling pipeline</span></span>

![显示从绝对类型到预处理器、API 提取程序、midprocessor、API 文档管理和到 postprocessor 的控制流的图像。](ToolingPipeline.png)

<span data-ttu-id="dc9df-149">在内容源和最终页面之间，文档内容将经历五个工具步骤：</span><span class="sxs-lookup"><span data-stu-id="dc9df-149">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="dc9df-150">预处理器脚本</span><span class="sxs-lookup"><span data-stu-id="dc9df-150">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="dc9df-151">API 提取程序</span><span class="sxs-lookup"><span data-stu-id="dc9df-151">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="dc9df-152">Midprocessor 脚本</span><span class="sxs-lookup"><span data-stu-id="dc9df-152">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="dc9df-153">API 文档</span><span class="sxs-lookup"><span data-stu-id="dc9df-153">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="dc9df-154">Postprocessor 脚本</span><span class="sxs-lookup"><span data-stu-id="dc9df-154">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="dc9df-155">预处理器采用 d. ts 文件，并将它们拆分为特定于主机的分区。</span><span class="sxs-lookup"><span data-stu-id="dc9df-155">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="dc9df-156">它执行后续工具正确处理数据所需的任何清理操作。</span><span class="sxs-lookup"><span data-stu-id="dc9df-156">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="dc9df-157">API 提取程序将 d. ts 文件转换为 JSON 数据。</span><span class="sxs-lookup"><span data-stu-id="dc9df-157">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="dc9df-158">此 tokenizes 所有类型数据，从而便于进行分析。</span><span class="sxs-lookup"><span data-stu-id="dc9df-158">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="dc9df-159">Midprocessor 检索代码段并将它们与适当的主机配对。</span><span class="sxs-lookup"><span data-stu-id="dc9df-159">The midprocessor retrieves the code snippets and pairs them with the proper hosts.</span></span>

<span data-ttu-id="dc9df-160">API 文档管理器将 JSON 数据转换为 yml 文件。</span><span class="sxs-lookup"><span data-stu-id="dc9df-160">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="dc9df-161">将文档发布到 docs.microsoft.com 的开放发布系统会将. yml 文件转换为 markdown。</span><span class="sxs-lookup"><span data-stu-id="dc9df-161">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="dc9df-162">API 文档管理器还包含一个特定于 Office 的扩展，用于插入代码段。</span><span class="sxs-lookup"><span data-stu-id="dc9df-162">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="dc9df-163">Postprocessor 清理目录并将. yml 文件移到[发布文件夹](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen)中。</span><span class="sxs-lookup"><span data-stu-id="dc9df-163">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="dc9df-164">在运行[GenerateDocs](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd)时，将执行上述所有五个步骤。</span><span class="sxs-lookup"><span data-stu-id="dc9df-164">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="dc9df-165">该脚本还处理节点模块安装、清除旧文件集和每个要求集的版本类型定义文件。</span><span class="sxs-lookup"><span data-stu-id="dc9df-165">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
